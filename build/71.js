webpackJsonp([71],{2156:function(n,e,l){"use strict";function t(n){return h._57(0,[(n()(),h._31(0,0,null,null,6,"button",[["clear",""],["icon-only",""],["ion-button",""],["item-end",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.toggleDelete(l)&&t}return t},Y.b,Y.a)),h._30(1,1097728,[[2,4]],0,Q.a,[[8,""],Z.a,h.t,h.V],{clear:[0,"clear"]},null),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,0,["\n                "])),(n()(),h._31(4,0,null,0,1,"ion-icon",[["ios","md-create"],["name","create"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._30(5,147456,null,0,ln.a,[Z.a,h.t,h.V],{name:[0,"name"],ios:[1,"ios"]},null),(n()(),h._55(-1,0,["\n            "]))],function(n,e){n(e,1,0,"");n(e,5,0,"create","md-create")},function(n,e){n(e,0,0,h._56(e,0,0,h._44(e,2).transform("core.delete")));n(e,4,0,h._44(e,5)._hidden)})}function o(n){return h._57(0,[(n()(),h._31(0,0,null,null,2,"core-empty-box",[["icon","chatbubbles"]],null,null,null,tn.b,tn.a)),h._30(1,49152,null,0,on.a,[],{message:[0,"message"],icon:[1,"icon"]},null),h._47(131072,nn.a,[en.a,h.j])],function(n,e){n(e,1,0,h._56(e,1,0,h._44(e,2).transform("core.comments.nocomments")),"chatbubbles")},null)}function a(n){return h._57(0,[(n()(),h._31(0,0,null,null,8,"div",[["class","core-warning-card"],["icon-start",""]],null,null,null,null,null)),(n()(),h._55(-1,null,["\n            "])),(n()(),h._31(2,0,null,null,1,"ion-icon",[["name","warning"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._30(3,147456,null,0,ln.a,[Z.a,h.t,h.V],{name:[0,"name"]},null),(n()(),h._55(4,null,["\n            ","\n        "])),h._47(131072,nn.a,[en.a,h.j]),h._49(6,1),h._48(7,{$a:0}),h._47(131072,nn.a,[en.a,h.j])],function(n,e){n(e,3,0,"warning")},function(n,e){n(e,2,0,h._44(e,3)._hidden);n(e,4,0,h._56(e,4,0,h._44(e,8).transform("core.thereisdatatosync",n(e,7,0,h._56(e,4,0,n(e,6,0,h._44(e.parent,0),h._56(e,4,0,h._44(e,5).transform("core.comments.comments"))))))))})}function i(n){return h._57(0,[(n()(),h._31(0,0,null,null,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[24,"@coreSlideInOut",0],[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0,o=n.component;if("click"===e){t=!1!==o.deleteComment(l,o.offlineComment)&&t}return t},Y.b,Y.a)),h._30(1,1097728,[[4,4]],0,Q.a,[[8,""],Z.a,h.t,h.V],{color:[0,"color"],clear:[1,"clear"]},null),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,0,["\n                    "])),(n()(),h._31(4,0,null,0,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._30(5,147456,null,0,ln.a,[Z.a,h.t,h.V],{name:[0,"name"]},null),(n()(),h._55(-1,0,["\n                "]))],function(n,e){n(e,1,0,"danger","");n(e,5,0,"trash")},function(n,e){n(e,0,0,"fromRight",h._56(e,0,1,h._44(e,2).transform("core.delete")));n(e,4,0,h._44(e,5)._hidden)})}function u(n){return h._57(0,[(n()(),h._31(0,0,null,null,38,"ion-card",[],null,[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.addComment(l)&&t}return t},null,null)),h._30(1,16384,null,0,an.a,[Z.a,h.t,h.V],null,null),(n()(),h._55(-1,null,["\n            "])),(n()(),h._31(3,0,null,null,23,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,un.b,un.a)),h._30(4,1097728,null,3,rn.a,[sn.a,Z.a,h.t,h.V,[2,cn.a]],null,null),h._52(335544320,3,{contentLabel:0}),h._52(603979776,4,{_buttons:1}),h._52(603979776,5,{_icons:1}),h._30(8,16384,null,0,mn.a,[],null,null),(n()(),h._55(-1,2,["\n                "])),(n()(),h._31(10,0,null,0,2,"ion-avatar",[["core-user-avatar",""],["item-start",""]],null,null,null,fn.b,fn.a)),h._30(11,770048,null,0,_n.a,[dn.a,v.a,hn.a,pn.a,x.a,[2,yn.a]],{user:[0,"user"]},null),h._30(12,16384,null,0,gn.a,[],null,null),(n()(),h._55(-1,2,["\n                "])),(n()(),h._31(14,0,null,2,1,"h2",[],null,null,null,null,null)),(n()(),h._55(15,null,["",""])),(n()(),h._55(-1,2,["\n                "])),(n()(),h._31(17,0,null,2,5,"p",[],null,null,null,null,null)),(n()(),h._55(-1,null,["\n                    "])),(n()(),h._31(19,0,null,null,1,"ion-icon",[["name","time"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._30(20,147456,[[5,4]],0,ln.a,[Z.a,h.t,h.V],{name:[0,"name"]},null),(n()(),h._55(21,null,[" ","\n                "])),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,2,["\n                "])),(n()(),h._26(16777216,null,4,1,null,i)),h._30(25,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,2,["\n            "])),(n()(),h._55(-1,null,["\n            "])),(n()(),h._31(28,0,null,null,9,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,un.b,un.a)),h._30(29,1097728,null,3,rn.a,[sn.a,Z.a,h.t,h.V,[2,cn.a]],null,null),h._52(335544320,6,{contentLabel:0}),h._52(603979776,7,{_buttons:1}),h._52(603979776,8,{_icons:1}),h._30(33,16384,null,0,mn.a,[],null,null),(n()(),h._55(-1,2,["\n                "])),(n()(),h._31(35,16777216,null,2,1,"core-format-text",[["clean","true"]],null,null,null,null,null)),h._30(36,540672,null,0,bn.a,[h.t,v.a,b.a,I.a,en.a,In.a,hn.a,Cn.a,xn.a,Dn.a,pn.a,Ln.a,[2,dn.a],[2,wn.a],[2,yn.a],On.a,x.a,Pn.a,kn.a,Un.a,h._11],{text:[0,"text"],clean:[1,"clean"],contextLevel:[2,"contextLevel"],contextInstanceId:[3,"contextInstanceId"],courseId:[4,"courseId"]},null),(n()(),h._55(-1,2,["\n            "])),(n()(),h._55(-1,null,["\n        "]))],function(n,e){var l=e.component;n(e,11,0,l.offlineComment);n(e,20,0,"time");n(e,25,0,l.showDelete);n(e,36,0,l.offlineComment.content,"true",l.contextLevel,l.instanceId,l.courseId)},function(n,e){n(e,15,0,e.component.offlineComment.fullname);n(e,19,0,h._44(e,20)._hidden);n(e,21,0,h._56(e,21,0,h._44(e,22).transform("core.notsent")))})}function r(n){return h._57(0,[(n()(),h._31(0,0,null,null,2,"p",[],null,null,null,null,null)),(n()(),h._55(1,null,["",""])),h._49(2,2)],null,function(n,e){n(e,1,0,h._56(e,1,0,n(e,2,0,h._44(e.parent.parent,1),1e3*e.parent.context.$implicit.timecreated,"strftimerecentfull")))})}function s(n){return h._57(0,[(n()(),h._31(0,0,null,null,8,"p",[],null,null,null,null,null)),(n()(),h._55(-1,null,["\n                    "])),(n()(),h._31(2,0,null,null,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._30(3,147456,[[11,4]],0,ln.a,[Z.a,h.t,h.V],{name:[0,"name"]},null),(n()(),h._55(-1,null,[" "])),(n()(),h._31(5,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),h._55(6,null,["",""])),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,null,["\n                "]))],function(n,e){n(e,3,0,"trash")},function(n,e){n(e,2,0,h._44(e,3)._hidden);n(e,6,0,h._56(e,6,0,h._44(e,7).transform("core.deletedoffline")))})}function c(n){return h._57(0,[(n()(),h._31(0,0,null,null,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[24,"@coreSlideInOut",0],[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.deleteComment(l,n.parent.context.$implicit)&&t}return t},Y.b,Y.a)),h._30(1,1097728,[[10,4]],0,Q.a,[[8,""],Z.a,h.t,h.V],{color:[0,"color"],clear:[1,"clear"]},null),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,0,["\n                    "])),(n()(),h._31(4,0,null,0,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._30(5,147456,null,0,ln.a,[Z.a,h.t,h.V],{name:[0,"name"]},null),(n()(),h._55(-1,0,["\n                "]))],function(n,e){n(e,1,0,"danger","");n(e,5,0,"trash")},function(n,e){n(e,0,0,"fromRight",h._56(e,0,1,h._44(e,2).transform("core.delete")));n(e,4,0,h._44(e,5)._hidden)})}function m(n){return h._57(0,[(n()(),h._31(0,0,null,null,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.undoDeleteComment(l,n.parent.context.$implicit)&&t}return t},Y.b,Y.a)),h._30(1,1097728,[[10,4]],0,Q.a,[[8,""],Z.a,h.t,h.V],{color:[0,"color"],clear:[1,"clear"]},null),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,0,["\n                    "])),(n()(),h._31(4,0,null,0,1,"ion-icon",[["name","undo"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._30(5,147456,null,0,ln.a,[Z.a,h.t,h.V],{name:[0,"name"]},null),(n()(),h._55(-1,0,["\n                "]))],function(n,e){n(e,1,0,"danger","");n(e,5,0,"undo")},function(n,e){n(e,0,0,h._56(e,0,0,h._44(e,2).transform("core.restore")));n(e,4,0,h._44(e,5)._hidden)})}function f(n){return h._57(0,[(n()(),h._31(0,0,null,null,40,"ion-card",[],null,null,null,null,null)),h._30(1,16384,null,0,an.a,[Z.a,h.t,h.V],null,null),(n()(),h._55(-1,null,["\n            "])),(n()(),h._31(3,0,null,null,25,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,un.b,un.a)),h._30(4,1097728,null,3,rn.a,[sn.a,Z.a,h.t,h.V,[2,cn.a]],null,null),h._52(335544320,9,{contentLabel:0}),h._52(603979776,10,{_buttons:1}),h._52(603979776,11,{_icons:1}),h._30(8,16384,null,0,mn.a,[],null,null),(n()(),h._55(-1,2,["\n                "])),(n()(),h._31(10,0,null,0,2,"ion-avatar",[["core-user-avatar",""],["item-start",""]],null,null,null,fn.b,fn.a)),h._30(11,770048,null,0,_n.a,[dn.a,v.a,hn.a,pn.a,x.a,[2,yn.a]],{user:[0,"user"]},null),h._30(12,16384,null,0,gn.a,[],null,null),(n()(),h._55(-1,2,["\n                "])),(n()(),h._31(14,0,null,2,1,"h2",[],null,null,null,null,null)),(n()(),h._55(15,null,["",""])),(n()(),h._55(-1,2,["\n                "])),(n()(),h._26(16777216,null,2,1,null,r)),h._30(18,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,2,["\n                "])),(n()(),h._26(16777216,null,2,1,null,s)),h._30(21,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,2,["\n                "])),(n()(),h._26(16777216,null,4,1,null,c)),h._30(24,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,2,["\n                "])),(n()(),h._26(16777216,null,4,1,null,m)),h._30(27,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,2,["\n            "])),(n()(),h._55(-1,null,["\n            "])),(n()(),h._31(30,0,null,null,9,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,un.b,un.a)),h._30(31,1097728,null,3,rn.a,[sn.a,Z.a,h.t,h.V,[2,cn.a]],null,null),h._52(335544320,12,{contentLabel:0}),h._52(603979776,13,{_buttons:1}),h._52(603979776,14,{_icons:1}),h._30(35,16384,null,0,mn.a,[],null,null),(n()(),h._55(-1,2,["\n                "])),(n()(),h._31(37,16777216,null,2,1,"core-format-text",[],null,null,null,null,null)),h._30(38,540672,null,0,bn.a,[h.t,v.a,b.a,I.a,en.a,In.a,hn.a,Cn.a,xn.a,Dn.a,pn.a,Ln.a,[2,dn.a],[2,wn.a],[2,yn.a],On.a,x.a,Pn.a,kn.a,Un.a,h._11],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"],courseId:[3,"courseId"]},null),(n()(),h._55(-1,2,["\n            "])),(n()(),h._55(-1,null,["\n        "]))],function(n,e){var l=e.component;n(e,11,0,e.context.$implicit);n(e,18,0,!e.context.$implicit.deleted);n(e,21,0,e.context.$implicit.deleted);n(e,24,0,l.showDelete&&!e.context.$implicit.deleted&&e.context.$implicit.delete);n(e,27,0,l.showDelete&&e.context.$implicit.deleted);n(e,38,0,e.context.$implicit.content,l.contextLevel,l.instanceId,l.courseId)},function(n,e){n(e,15,0,e.context.$implicit.fullname)})}function _(n){return h._57(0,[(n()(),h._31(0,0,null,null,13,"ion-fab",[["bottom",""],["core-fab",""],["end",""]],null,null,null,Vn.b,Vn.a)),h._30(1,212992,null,0,jn.a,[h.t,wn.a],null,null),h._30(2,1228800,null,2,Nn.a,[In.a],null,null),h._52(335544320,15,{_mainButton:0}),h._52(603979776,16,{_fabLists:1}),(n()(),h._55(-1,0,["\n        "])),(n()(),h._31(6,0,null,0,6,"button",[["ion-fab",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.addComment(l)&&t}return t},Mn.b,Mn.a)),h._30(7,49152,[[15,4]],0,An.a,[Z.a,h.t,h.V],null,null),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,0,["\n            "])),(n()(),h._31(10,0,null,0,1,"ion-icon",[["name","add"],["role","img"]],[[2,"hide",null]],null,null,null,null)),h._30(11,147456,null,0,ln.a,[Z.a,h.t,h.V],{name:[0,"name"]},null),(n()(),h._55(-1,0,["\n        "])),(n()(),h._55(-1,0,["\n    "]))],function(n,e){n(e,1,0);n(e,11,0,"add")},function(n,e){n(e,6,0,h._56(e,6,0,h._44(e,8).transform("core.comments.addcomment")));n(e,10,0,h._44(e,11)._hidden)})}function d(n){return h._57(0,[h._47(0,vn.h,[]),h._47(0,En.a,[xn.a,C.a]),h._52(402653184,1,{content:0}),(n()(),h._31(3,0,null,null,32,"ion-header",[],null,null,null,null,null)),h._30(4,16384,null,0,Rn.a,[Z.a,h.t,h.V,[2,Sn.a]],null,null),(n()(),h._55(-1,null,["\n    "])),(n()(),h._31(6,0,null,null,28,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Xn.b,Xn.a)),h._30(7,49152,null,0,Tn.a,[$n.a,[2,Sn.a],[2,dn.a],Z.a,h.t,h.V],null,null),h._30(8,212992,null,0,Fn.a,[Tn.a,In.a,en.a,x.a],null,null),(n()(),h._55(-1,3,["\n        "])),(n()(),h._31(10,0,null,3,3,"ion-title",[],null,null,null,Gn.b,Gn.a)),h._30(11,49152,null,0,Wn.a,[Z.a,h.t,h.V,[2,zn.a],[2,Tn.a]],null,null),(n()(),h._31(12,16777216,null,0,1,"core-format-text",[],null,null,null,null,null)),h._30(13,540672,null,0,bn.a,[h.t,v.a,b.a,I.a,en.a,In.a,hn.a,Cn.a,xn.a,Dn.a,pn.a,Ln.a,[2,dn.a],[2,wn.a],[2,yn.a],On.a,x.a,Pn.a,kn.a,Un.a,h._11],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"],courseId:[3,"courseId"]},null),(n()(),h._55(-1,3,["\n        "])),(n()(),h._31(15,0,null,2,18,"ion-buttons",[["end",""]],null,null,null,null,null)),h._30(16,16384,null,1,Hn.a,[Z.a,h.t,h.V,[2,zn.a],[2,Tn.a]],null,null),h._52(603979776,2,{_buttons:1}),(n()(),h._55(-1,null,["\n            "])),(n()(),h._26(16777216,null,null,1,null,t)),h._30(20,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,null,["\n            "])),(n()(),h._31(22,0,null,null,10,"core-context-menu",[],null,null,null,qn.b,qn.a)),h._30(23,245760,null,0,Bn.a,[en.a,Jn.a,h.t,b.a,[2,Kn.a],hn.a],null,null),(n()(),h._55(-1,0,["\n                "])),(n()(),h._31(25,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.refreshComments(!1)&&t}return t},Yn.b,Yn.a)),h._30(26,770048,null,0,Qn.a,[Bn.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,0,["\n                "])),(n()(),h._31(29,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.refreshComments(!0)&&t}return t},Yn.b,Yn.a)),h._30(30,770048,null,0,Qn.a,[Bn.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,0,["\n            "])),(n()(),h._55(-1,null,["\n        "])),(n()(),h._55(-1,3,["\n    "])),(n()(),h._55(-1,null,["\n"])),(n()(),h._55(-1,null,["\n"])),(n()(),h._31(37,0,null,null,32,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,Zn.b,Zn.a)),h._30(38,4374528,[[1,4]],0,wn.a,[Z.a,In.a,ne.a,h.t,h.V,$n.a,ee.a,h.M,[2,Sn.a],[2,dn.a]],null,null),(n()(),h._55(-1,1,["\n    "])),(n()(),h._31(40,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(n,e,l){var t=!0;if("ionRefresh"===e){t=!1!==n.component.refreshComments(!1,l)&&t}return t},null,null)),h._30(41,212992,null,0,le.a,[In.a,wn.a,h.M,te.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(n()(),h._55(-1,null,["\n        "])),(n()(),h._31(43,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,oe.b,oe.a)),h._30(44,114688,null,0,ae.a,[le.a,Z.a],{pullingText:[0,"pullingText"]},null),h._47(131072,nn.a,[en.a,h.j]),(n()(),h._55(-1,null,["\n    "])),(n()(),h._55(-1,1,["\n    "])),(n()(),h._31(48,0,null,1,17,"core-loading",[],null,null,null,ie.b,ie.a)),h._30(49,638976,null,0,ue.a,[en.a,h.t,x.a,hn.a],{hideUntil:[0,"hideUntil"]},null),(n()(),h._55(-1,0,["\n        "])),(n()(),h._26(16777216,null,0,1,null,o)),h._30(52,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,0,["\n\n        "])),(n()(),h._26(16777216,null,0,1,null,a)),h._30(55,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,0,["\n\n        "])),(n()(),h._26(16777216,null,0,1,null,u)),h._30(58,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,0,["\n\n        "])),(n()(),h._26(16777216,null,0,1,null,f)),h._30(61,802816,null,0,vn.j,[h._11,h._6,h.E],{ngForOf:[0,"ngForOf"]},null),(n()(),h._55(-1,0,["\n\n        "])),(n()(),h._31(63,0,null,0,1,"core-infinite-loading",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.loadMore(l)&&t}return t},re.b,re.a)),h._30(64,573440,null,0,se.a,[[2,wn.a],b.a],{enabled:[0,"enabled"],error:[1,"error"]},{action:"action"}),(n()(),h._55(-1,0,["\n    "])),(n()(),h._55(-1,1,["\n\n    "])),(n()(),h._26(16777216,null,0,1,null,_)),h._30(68,16384,null,0,vn.k,[h._11,h._6],{ngIf:[0,"ngIf"]},null),(n()(),h._55(-1,1,["\n"])),(n()(),h._55(-1,null,["\n"]))],function(n,e){var l=e.component;n(e,8,0);n(e,13,0,l.title,l.contextLevel,l.instanceId,l.courseId);n(e,20,0,l.canDeleteComments),n(e,23,0);n(e,26,0,h._56(e,26,0,h._44(e,27).transform("core.refresh")),l.refreshIcon,!0,100,!(l.commentsLoaded&&!l.hasOffline));n(e,30,0,h._56(e,30,0,h._44(e,31).transform("core.settings.synchronizenow")),l.syncIcon,!1,100,!(l.commentsLoaded&&l.hasOffline));n(e,41,0,l.commentsLoaded);n(e,44,0,h._34(1,"",h._56(e,44,0,h._44(e,45).transform("core.pulltorefresh")),""));n(e,49,0,l.commentsLoaded);n(e,52,0,!l.comments||!l.comments.length);n(e,55,0,l.hasOffline);n(e,58,0,l.offlineComment);n(e,61,0,l.comments);n(e,64,0,l.canLoadMore,l.loadMoreError);n(e,68,0,l.canAddComments)},function(n,e){n(e,6,0,h._44(e,7)._hidden,h._44(e,7)._sbPadding);n(e,37,0,h._44(e,38).statusbarPadding,h._44(e,38)._hasRefresher);n(e,40,0,"inactive"!==h._44(e,41).state,h._44(e,41)._top);n(e,43,0,h._44(e,44).r.state)})}Object.defineProperty(e,"__esModule",{value:!0});var h=l(0),p=l(5),y=l(3),g=l(746),v=l(1),b=l(4),I=l(11),C=l(24),x=l(10),D=l(46),L=l(154),w=l(391),O=l(524),P=this&&this.__decorate||function(n,e,l,t){var o,a=arguments.length,i=a<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,l):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,l,t);else for(var u=n.length-1;u>=0;u--)(o=n[u])&&(i=(a<3?o(i):a>3?o(e,l,i):o(e,l))||i);return a>3&&i&&Object.defineProperty(e,l,i),i},k=this&&this.__metadata||function(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)},U=function(){function n(n,e,l,t,o,a,i,u,r,s,c,m){var f=this;this.sitesProvider=e,this.userProvider=l,this.domUtils=t,this.translate=o,this.modalCtrl=a,this.commentsProvider=i,this.offlineComments=u,this.eventsProvider=r,this.commentsSync=s,this.textUtils=c,this.timeUtils=m,this.comments=[],this.commentsLoaded=!1,this.canLoadMore=!1,this.loadMoreError=!1,this.canAddComments=!1,this.canDeleteComments=!1,this.showDelete=!1,this.hasOffline=!1,this.refreshIcon="spinner",this.syncIcon="spinner",this.addDeleteCommentsAvailable=!1,this.contextLevel=n.get("contextLevel"),this.instanceId=n.get("instanceId"),this.componentName=n.get("componentName"),this.itemId=n.get("itemId"),this.area=n.get("area")||"",this.title=n.get("title")||this.translate.instant("core.comments.comments"),this.courseId=n.get("courseId"),this.page=0,this.syncObserver=r.on(O.a.AUTO_SYNCED,function(n){n.contextLevel==f.contextLevel&&n.instanceId==f.instanceId&&n.componentName==f.componentName&&n.itemId==f.itemId&&n.area==f.area&&(f.showSyncWarnings(n.warnings),f.commentsLoaded=!1,f.refreshIcon="spinner",f.syncIcon="spinner",f.domUtils.scrollToTop(f.content),f.page=0,f.comments=[],f.fetchComments(!1))},e.getCurrentSiteId())}return n.prototype.ionViewDidLoad=function(){var n=this;this.commentsProvider.isAddCommentsAvailable().then(function(e){n.addDeleteCommentsAvailable=e}),this.currentUserId=this.sitesProvider.getCurrentSiteUserId(),this.fetchComments(!0)},n.prototype.fetchComments=function(n,e){var l=this;this.loadMoreError=!1;return(n?this.syncComments(e):Promise.resolve()).catch(function(){}).then(function(){return l.commentsProvider.getComments(l.contextLevel,l.instanceId,l.componentName,l.itemId,l.area,l.page).then(function(n){l.canAddComments=l.addDeleteCommentsAvailable&&n.canpost;var e=n.comments.sort(function(n,e){return e.timecreated-n.timecreated});return l.canLoadMore=void 0!==n.count?l.comments.length+e.length>n.count:n.comments.length>0&&n.comments.length>=L.a.pageSize,Promise.all(e.map(function(n){return l.loadCommentProfile(n)}))}).then(function(n){l.comments=l.comments.concat(n),l.canDeleteComments=l.addDeleteCommentsAvailable&&(l.hasOffline||l.comments.some(function(n){return!!n.delete}))})}).then(function(){return l.loadOfflineData()}).catch(function(n){l.loadMoreError=!0,n&&"assignsubmission_comments"==l.componentName?l.domUtils.showAlertTranslated("core.notice","core.comments.commentsnotworking"):l.domUtils.showErrorModalDefault(n,l.translate.instant("core.error")+": get_comments")}).finally(function(){l.commentsLoaded=!0,l.refreshIcon="refresh",l.syncIcon="sync"})},n.prototype.loadMore=function(n){return this.page++,this.canLoadMore=!1,this.fetchComments(!0).finally(function(){n&&n()})},n.prototype.refreshComments=function(n,e){var l=this;return this.commentsLoaded=!1,this.refreshIcon="spinner",this.syncIcon="spinner",this.invalidateComments().finally(function(){return l.page=0,l.comments=[],l.fetchComments(!0,n).finally(function(){e&&e.complete()})})},n.prototype.showSyncWarnings=function(n){var e=this.textUtils.buildMessage(n);e&&this.domUtils.showErrorModal(e)},n.prototype.syncComments=function(n){var e=this;return this.commentsSync.syncComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then(function(n){e.showSyncWarnings(n)}).catch(function(l){return n&&e.domUtils.showErrorModalDefault(l,"core.errorsync",!0),Promise.reject(null)})},n.prototype.addComment=function(n){var e=this;n.preventDefault(),n.stopPropagation();var l=this.modalCtrl.create("CoreCommentsAddPage",{contextLevel:this.contextLevel,instanceId:this.instanceId,componentName:this.componentName,itemId:this.itemId,area:this.area,content:this.hasOffline?this.offlineComment.content:""});l.onDidDismiss(function(n){return n&&n.comments?(e.invalidateComments(),Promise.all(n.comments.map(function(n){return e.loadCommentProfile(n)})).then(function(n){e.comments=n.concat(e.comments),e.canDeleteComments=e.addDeleteCommentsAvailable,e.eventsProvider.trigger(L.a.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:e.contextLevel,instanceId:e.instanceId,component:e.componentName,itemId:e.itemId,area:e.area,countChange:n.length},e.sitesProvider.getCurrentSiteId())})):n&&!n.comments?e.loadOfflineData():void 0}),l.present()},n.prototype.deleteComment=function(n,e){var l=this;n.preventDefault(),n.stopPropagation();var t=this.timeUtils.userDate(1e3*(e.lastmodified||e.timecreated),"core.strftimerecentfull");e.contextlevel=this.contextLevel,e.instanceid=this.instanceId,e.component=this.componentName,e.itemid=this.itemId,e.area=this.area,this.domUtils.showDeleteConfirm("core.comments.deletecommentbyon",{$a:{user:e.fullname||"",time:t}}).then(function(){l.commentsProvider.deleteComment(e).then(function(n){if(l.showDelete=!1,n){var t=l.comments.findIndex(function(n){return n.id==e.id});t>=0&&(l.comments.splice(t,1),l.eventsProvider.trigger(L.a.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:l.contextLevel,instanceId:l.instanceId,component:l.componentName,itemId:l.itemId,area:l.area,countChange:-1},l.sitesProvider.getCurrentSiteId()))}else l.loadOfflineData();l.invalidateComments(),l.domUtils.showToast("core.comments.eventcommentdeleted",!0,3e3)}).catch(function(n){l.domUtils.showErrorModalDefault(n,"Delete comment failed.")})}).catch(function(){})},n.prototype.invalidateComments=function(){return this.commentsProvider.invalidateCommentsData(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area)},n.prototype.loadCommentProfile=function(n){return this.userProvider.getProfile(n.userid,void 0,!0).then(function(e){return n.profileimageurl=e.profileimageurl,n.fullname=e.fullname,n.userid=e.id,n}).catch(function(){return n})},n.prototype.loadOfflineData=function(){var n=this,e=[],l=!1;return e.push(this.offlineComments.getComment(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then(function(e){e&&!n.currentUser?(e.userid=n.currentUserId,n.loadCommentProfile(e).then(function(e){e.fullname&&(n.currentUser={},n.currentUser.profileimageurl=e.profileimageurl,n.currentUser.fullname=e.fullname,n.currentUser.userid=e.userid)})):e&&(e.profileimageurl=n.currentUser.profileimageurl,e.fullname=n.currentUser.fullname,e.userid=n.currentUser.id),n.offlineComment=e})),e.push(this.offlineComments.getDeletedComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then(function(e){(l=e&&e.length>0)&&e.forEach(function(e){var l=n.comments.find(function(n){return n.id==e.commentid});l&&(l.deleted=e.deleted)})})),Promise.all(e).then(function(){n.hasOffline=!!n.offlineComment||l})},n.prototype.undoDeleteComment=function(n,e){var l=this;n.preventDefault(),n.stopPropagation(),this.offlineComments.undoDeleteComment(e.id).then(function(){e.deleted=!1,l.showDelete=!1})},n.prototype.toggleDelete=function(){this.showDelete=!this.showDelete},n.prototype.ngOnDestroy=function(){this.syncObserver&&this.syncObserver.off()},P([Object(h._9)(p.f),k("design:type",p.f)],n.prototype,"content",void 0),n=P([Object(h.m)({selector:"page-core-comments-viewer",templateUrl:"viewer.html",animations:[g.b]}),k("design:paramtypes",[p.t,v.a,D.a,b.a,y.c,p.q,L.a,w.a,x.a,O.a,I.a,C.a])],n)}(),V=l(28),j=l(32),N=l(108),M=l(377),A=this&&this.__decorate||function(n,e,l,t){var o,a=arguments.length,i=a<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,l):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,l,t);else for(var u=n.length-1;u>=0;u--)(o=n[u])&&(i=(a<3?o(i):a>3?o(e,l,i):o(e,l))||i);return a>3&&i&&Object.defineProperty(e,l,i),i},E=function(){function n(){}return n=A([Object(h.I)({declarations:[U],imports:[V.a,j.a,N.a,M.a,p.l.forChild(U),y.b.forChild()]})],n)}(),R=l(1525),S=l(1526),X=l(1527),T=l(1528),$=l(1529),F=l(1530),G=l(1531),W=l(1532),z=l(1533),H=l(1534),q=l(1535),B=l(1536),J=l(1537),K=l(483),Y=l(45),Q=l(41),Z=l(8),nn=l(25),en=l(17),ln=l(47),tn=l(126),on=l(116),an=l(91),un=l(30),rn=l(20),sn=l(19),cn=l(26),mn=l(33),fn=l(215),_n=l(183),dn=l(21),hn=l(2),pn=l(9),yn=l(27),gn=l(161),vn=l(7),bn=l(48),In=l(16),Cn=l(22),xn=l(6),Dn=l(18),Ln=l(15),wn=l(29),On=l(43),Pn=l(42),kn=l(31),Un=l(36),Vn=l(283),jn=l(258),Nn=l(218),Mn=l(284),An=l(191),En=l(229),Rn=l(374),Sn=l(39),Xn=l(724),Tn=l(213),$n=l(35),Fn=l(477),Gn=l(725),Wn=l(315),zn=l(250),Hn=l(375),qn=l(93),Bn=l(79),Jn=l(71),Kn=l(77),Yn=l(94),Qn=l(84),Zn=l(182),ne=l(34),ee=l(109),le=l(160),te=l(44),oe=l(214),ae=l(174),ie=l(54),ue=l(51),re=l(376),se=l(275),ce=l(70),me=l(163),fe=h._29({encapsulation:2,styles:[],data:{animation:[{type:7,name:"coreSlideInOut",definitions:[{type:1,expr:"void => fromLeft",animation:[{type:6,styles:{transform:"translateX(0)",opacity:1},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:0,transform:"translateX(-100%)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(5%)",offset:.7},offset:null},{type:6,styles:{opacity:1,transform:"translateX(0)",offset:1},offset:null}]},timings:300}],options:null},{type:1,expr:"fromLeft => void",animation:[{type:6,styles:{transform:"translateX(-100%)",opacity:0},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:1,transform:"translateX(0)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(5%)",offset:.3},offset:null},{type:6,styles:{opacity:0,transform:"translateX(-100%)",offset:1},offset:null}]},timings:300}],options:null},{type:1,expr:"void => fromRight",animation:[{type:6,styles:{transform:"translateX(0)",opacity:1},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:0,transform:"translateX(100%)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(-5%)",offset:.7},offset:null},{type:6,styles:{opacity:1,transform:"translateX(0)",offset:1},offset:null}]},timings:300}],options:null},{type:1,expr:"fromRight => void",animation:[{type:6,styles:{transform:"translateX(-100%)",opacity:0},offset:null},{type:4,styles:{type:5,steps:[{type:6,styles:{opacity:1,transform:"translateX(0)",offset:0},offset:null},{type:6,styles:{opacity:1,transform:"translateX(-5%)",offset:.3},offset:null},{type:6,styles:{opacity:0,transform:"translateX(100%)",offset:1},offset:null}]},timings:300}],options:null}],options:{}}]}}),_e=h._27("page-core-comments-viewer",U,function(n){return h._57(0,[(n()(),h._31(0,0,null,null,1,"page-core-comments-viewer",[],null,null,null,d,fe)),h._30(1,180224,null,0,U,[ce.a,v.a,D.a,b.a,en.a,me.a,L.a,w.a,x.a,O.a,I.a,C.a],null,null)],null,null)},{},{},[]),de=l(23),he=l(370),pe=l(371),ye=l(373),ge=l(372),ve=l(476),be=l(723),Ie=l(273);l.d(e,"CoreCommentsViewerPageModuleNgFactory",function(){return Ce});var Ce=h._28(E,[],function(n){return h._40([h._41(512,h.o,h._21,[[8,[R.a,S.a,X.a,T.a,$.a,F.a,G.a,W.a,z.a,H.a,q.a,B.a,J.a,K.a,_e]],[3,h.o],h.K]),h._41(4608,vn.m,vn.l,[h.G,[2,vn.w]]),h._41(4608,de.x,de.x,[]),h._41(4608,de.d,de.d,[]),h._41(4608,he.b,he.a,[]),h._41(4608,pe.a,pe.b,[]),h._41(4608,ye.b,ye.a,[]),h._41(4608,ge.b,ge.a,[]),h._41(4608,en.a,en.a,[ve.a,he.b,pe.a,ye.b,ge.b,en.b,en.c]),h._41(512,vn.b,vn.b,[]),h._41(512,de.v,de.v,[]),h._41(512,de.i,de.i,[]),h._41(512,de.s,de.s,[]),h._41(512,be.a,be.a,[]),h._41(512,y.b,y.b,[]),h._41(512,j.a,j.a,[]),h._41(512,N.a,N.a,[]),h._41(512,V.a,V.a,[]),h._41(512,M.a,M.a,[]),h._41(512,be.b,be.b,[]),h._41(512,E,E,[]),h._41(256,en.c,void 0,[]),h._41(256,en.b,void 0,[]),h._41(256,Ie.a,U,[])])})}});