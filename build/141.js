webpackJsonp([141],{2159:function(n,l,e){"use strict";function t(n){return y._57(0,[(n()(),y._31(0,0,null,null,1,"ion-icon",[["name","funnel"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._30(1,147456,null,0,tn.a,[an.a,y.t,y.V],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"funnel")},function(n,l){n(l,0,0,y._44(l,1)._hidden)})}function a(n){return y._57(0,[(n()(),y._31(0,0,null,null,1,"ion-icon",[["name","ios-funnel-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._30(1,147456,null,0,tn.a,[an.a,y.t,y.V],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"ios-funnel-outline")},function(n,l){n(l,0,0,y._44(l,1)._hidden)})}function i(n){return y._57(0,[(n()(),y._31(0,0,null,null,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,l,e){var t=!0;if("action"===l){t=!1!==n.component.goToCurrentDay()&&t}return t},rn.b,rn.a)),y._30(1,770048,null,0,un.a,[on.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"]},{action:"action"}),y._47(131072,sn.a,[cn.a,y.j])],function(n,l){n(l,1,0,y._56(l,1,0,y._44(l,2).transform("addon.calendar.today")),"fa-calendar-times-o",900)},null)}function r(n){return y._57(0,[(n()(),y._31(0,0,null,null,10,"ion-col",[["class","col"],["text-start",""]],null,null,null,null,null)),y._30(1,16384,null,0,dn.a,[],null,null),(n()(),y._55(-1,null,["\n                "])),(n()(),y._31(3,0,null,null,6,"a",[["clear",""],["icon-only",""],["ion-button",""]],[[8,"title",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.loadPrevious()&&t}return t},fn.b,fn.a)),y._30(4,1097728,null,0,_n.a,[[8,""],an.a,y.t,y.V],{clear:[0,"clear"]},null),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,0,["\n                    "])),(n()(),y._31(7,0,null,0,1,"ion-icon",[["md","ios-arrow-back"],["name","arrow-back"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._30(8,147456,null,0,tn.a,[an.a,y.t,y.V],{name:[0,"name"],md:[1,"md"]},null),(n()(),y._55(-1,0,["\n                "])),(n()(),y._55(-1,null,["\n            "]))],function(n,l){n(l,4,0,"");n(l,8,0,"arrow-back","ios-arrow-back")},function(n,l){n(l,3,0,y._56(l,3,0,y._44(l,5).transform("addon.calendar.dayprev")));n(l,7,0,y._44(l,8)._hidden)})}function u(n){return y._57(0,[(n()(),y._31(0,0,null,null,10,"ion-col",[["class","col"],["text-end",""]],null,null,null,null,null)),y._30(1,16384,null,0,dn.a,[],null,null),(n()(),y._55(-1,null,["\n                "])),(n()(),y._31(3,0,null,null,6,"a",[["clear",""],["icon-only",""],["ion-button",""]],[[8,"title",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.loadNext()&&t}return t},fn.b,fn.a)),y._30(4,1097728,null,0,_n.a,[[8,""],an.a,y.t,y.V],{clear:[0,"clear"]},null),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,0,["\n                    "])),(n()(),y._31(7,0,null,0,1,"ion-icon",[["md","ios-arrow-forward"],["name","arrow-forward"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._30(8,147456,null,0,tn.a,[an.a,y.t,y.V],{name:[0,"name"],md:[1,"md"]},null),(n()(),y._55(-1,0,["\n                "])),(n()(),y._55(-1,null,["\n            "]))],function(n,l){n(l,4,0,"");n(l,8,0,"arrow-forward","ios-arrow-forward")},function(n,l){n(l,3,0,y._56(l,3,0,y._44(l,5).transform("addon.calendar.daynext")));n(l,7,0,y._44(l,8)._hidden)})}function o(n){return y._57(0,[(n()(),y._31(0,0,null,null,8,"ion-card",[["class","core-warning-card"],["icon-start",""]],null,null,null,null,null)),y._30(1,16384,null,0,hn.a,[an.a,y.t,y.V],null,null),(n()(),y._55(-1,null,["\n            "])),(n()(),y._31(3,0,null,null,1,"ion-icon",[["name","warning"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._30(4,147456,null,0,tn.a,[an.a,y.t,y.V],{name:[0,"name"]},null),(n()(),y._55(5,null,[" ","\n        "])),y._47(131072,sn.a,[cn.a,y.j]),y._48(7,{$a:0}),y._47(131072,sn.a,[cn.a,y.j])],function(n,l){n(l,4,0,"warning")},function(n,l){n(l,3,0,y._44(l,4)._hidden);n(l,5,0,y._56(l,5,0,y._44(l,8).transform("core.hasdatatosync",n(l,7,0,y._56(l,5,0,y._44(l,6).transform("core.day"))))))})}function s(n){return y._57(0,[(n()(),y._31(0,0,null,null,3,"core-empty-box",[["icon","calendar"]],null,null,null,mn.b,mn.a)),y._30(1,49152,null,0,vn.a,[],{message:[0,"message"],icon:[1,"icon"]},null),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,0,["\n        "]))],function(n,l){n(l,1,0,y._56(l,1,0,y._44(l,2).transform("addon.calendar.noevents")),"calendar")},null)}function c(n){return y._57(0,[(n()(),y._31(0,0,null,null,0,"img",[["class","core-module-icon"],["item-start",""]],[[8,"src",4]],null,null,null,null))],null,function(n,l){n(l,0,0,y._34(1,"",l.parent.context.$implicit.moduleIcon,""))})}function d(n){return y._57(0,[(n()(),y._31(0,0,null,null,1,"core-icon",[["item-start",""]],null,null,null,pn.b,pn.a)),y._30(1,704512,null,0,yn.a,[y.t,an.a],{name:[0,"name"]},null)],function(n,l){n(l,1,0,l.parent.context.$implicit.eventIcon)},null)}function f(n){return y._57(0,[(n()(),y._31(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),y._30(1,16384,null,0,gn.a,[an.a,y.t,y.V],null,null),(n()(),y._55(-1,null,["\n                        "])),(n()(),y._31(3,0,null,null,1,"ion-icon",[["name","time"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._30(4,147456,null,0,tn.a,[an.a,y.t,y.V],{name:[0,"name"]},null),(n()(),y._55(-1,null,["\n                        "])),(n()(),y._31(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),y._55(7,null,["",""])),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,null,["\n                    "]))],function(n,l){n(l,4,0,"time")},function(n,l){n(l,3,0,y._44(l,4)._hidden);n(l,7,0,y._56(l,7,0,y._44(l,8).transform("core.notsent")))})}function _(n){return y._57(0,[(n()(),y._31(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),y._30(1,16384,null,0,gn.a,[an.a,y.t,y.V],null,null),(n()(),y._55(-1,null,["\n                        "])),(n()(),y._31(3,0,null,null,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._30(4,147456,null,0,tn.a,[an.a,y.t,y.V],{name:[0,"name"]},null),(n()(),y._55(-1,null,["\n                        "])),(n()(),y._31(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),y._55(7,null,["",""])),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,null,["\n                    "]))],function(n,l){n(l,4,0,"trash")},function(n,l){n(l,3,0,y._44(l,4)._hidden);n(l,7,0,y._56(l,7,0,y._44(l,8).transform("core.deletedoffline")))})}function h(n){return y._57(0,[(n()(),y._31(0,0,null,null,29,null,null,null,null,null,null,null)),(n()(),y._55(-1,null,["\n                "])),(n()(),y._31(2,0,null,null,26,"a",[["class","addon-calendar-event item item-block"],["ion-item",""],["text-wrap",""]],[[8,"title",0],[2,"item-dimmed",null]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.gotoEvent(n.context.$implicit.id)&&t}return t},En.b,En.a)),y._30(3,278528,null,0,bn.i,[y.E,y.F,y.t,y.W],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),y._46(4,1),y._30(5,1097728,null,3,In.a,[Dn.a,an.a,y.t,y.V,[2,On.a]],null,null),y._52(335544320,2,{contentLabel:0}),y._52(603979776,3,{_buttons:1}),y._52(603979776,4,{_icons:1}),y._30(9,16384,null,0,Cn.a,[],null,null),(n()(),y._55(-1,2,["\n                    "])),(n()(),y._26(16777216,null,0,1,null,c)),y._30(12,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,2,["\n                    "])),(n()(),y._26(16777216,null,0,1,null,d)),y._30(15,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,2,["\n                    "])),(n()(),y._31(17,0,null,2,2,"h2",[],null,null,null,null,null)),(n()(),y._31(18,16777216,null,null,1,"core-format-text",[],null,null,null,null,null)),y._30(19,540672,null,0,xn.a,[y.t,w.a,P.a,wn.a,cn.a,Pn.a,Mn.a,kn.a,Tn.a,Vn.a,O.a,Nn.a,[2,jn.a],[2,An.a],[2,Sn.a],Fn.a,C.a,Rn.a,Un.a,$n.a,y._11],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"]},null),(n()(),y._55(-1,2,["\n                    "])),(n()(),y._31(21,0,null,2,0,"p",[],[[8,"innerHTML",1]],null,null,null,null)),(n()(),y._55(-1,2,["\n                    "])),(n()(),y._26(16777216,null,4,1,null,f)),y._30(24,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,2,["\n                    "])),(n()(),y._26(16777216,null,4,1,null,_)),y._30(27,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,2,["\n                "])),(n()(),y._55(-1,null,["\n            "]))],function(n,l){n(l,3,0,"addon-calendar-event",n(l,4,0,"addon-calendar-eventtype-"+l.context.$implicit.eventtype));n(l,12,0,l.context.$implicit.moduleIcon);n(l,15,0,l.context.$implicit.eventIcon&&!l.context.$implicit.moduleIcon);n(l,19,0,l.context.$implicit.name,l.context.$implicit.contextLevel,l.context.$implicit.contextInstanceId);n(l,24,0,l.context.$implicit.offline&&!l.context.$implicit.deleted);n(l,27,0,l.context.$implicit.deleted)},function(n,l){n(l,2,0,l.context.$implicit.name,l.context.$implicit.ispast);n(l,21,0,l.context.$implicit.formattedtime)})}function m(n){return y._57(0,[(n()(),y._31(0,0,null,null,5,"ion-list",[["no-margin",""]],null,null,null,null,null)),y._30(1,16384,null,0,Ln.a,[an.a,y.t,y.V,Pn.a,Hn.l,Yn.a],null,null),(n()(),y._55(-1,null,["\n            "])),(n()(),y._26(16777216,null,null,1,null,h)),y._30(4,802816,null,0,bn.j,[y._11,y._6,y.E],{ngForOf:[0,"ngForOf"]},null),(n()(),y._55(-1,null,["\n        "]))],function(n,l){n(l,4,0,l.component.filteredEvents)},null)}function v(n){return y._57(0,[(n()(),y._31(0,0,null,null,13,"ion-fab",[["bottom",""],["core-fab",""],["end",""]],null,null,null,Gn.b,Gn.a)),y._30(1,212992,null,0,Wn.a,[y.t,An.a],null,null),y._30(2,1228800,null,2,zn.a,[Pn.a],null,null),y._52(335544320,5,{_mainButton:0}),y._52(603979776,6,{_fabLists:1}),(n()(),y._55(-1,0,["\n            "])),(n()(),y._31(6,0,null,0,6,"button",[["ion-fab",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.openEdit()&&t}return t},Bn.b,Bn.a)),y._30(7,49152,[[5,4]],0,Jn.a,[an.a,y.t,y.V],null,null),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,0,["\n                "])),(n()(),y._31(10,0,null,0,1,"ion-icon",[["name","add"],["role","img"]],[[2,"hide",null]],null,null,null,null)),y._30(11,147456,null,0,tn.a,[an.a,y.t,y.V],{name:[0,"name"]},null),(n()(),y._55(-1,0,["\n            "])),(n()(),y._55(-1,0,["\n        "]))],function(n,l){n(l,1,0);n(l,11,0,"add")},function(n,l){n(l,6,0,y._56(l,6,0,y._44(l,8).transform("addon.calendar.newevent")));n(l,10,0,y._44(l,11)._hidden)})}function p(n){return y._57(0,[(n()(),y._31(0,0,null,null,39,"ion-header",[],null,null,null,null,null)),y._30(1,16384,null,0,Kn.a,[an.a,y.t,y.V,[2,qn.a]],null,null),(n()(),y._55(-1,null,["\n    "])),(n()(),y._31(3,0,null,null,35,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Qn.b,Qn.a)),y._30(4,49152,null,0,Xn.a,[Zn.a,[2,qn.a],[2,jn.a],an.a,y.t,y.V],null,null),y._30(5,212992,null,0,nl.a,[Xn.a,Pn.a,cn.a,C.a],null,null),(n()(),y._55(-1,3,["\n        "])),(n()(),y._31(7,0,null,3,3,"ion-title",[],null,null,null,ll.b,ll.a)),y._30(8,49152,null,0,el.a,[an.a,y.t,y.V,[2,tl.a],[2,Xn.a]],null,null),(n()(),y._55(9,0,["",""])),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,3,["\n        "])),(n()(),y._31(12,0,null,2,25,"ion-buttons",[["end",""]],null,null,null,null,null)),y._30(13,16384,null,1,al.a,[an.a,y.t,y.V,[2,tl.a],[2,Xn.a]],null,null),y._52(603979776,1,{_buttons:1}),(n()(),y._55(-1,null,["\n            "])),(n()(),y._31(16,0,null,null,9,"button",[["icon-only",""],["ion-button",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,l,e){var t=!0;if("click"===l){t=!1!==n.component.openFilter(e)&&t}return t},fn.b,fn.a)),y._30(17,1097728,[[1,4]],0,_n.a,[[8,""],an.a,y.t,y.V],null,null),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,0,["\n                "])),(n()(),y._26(16777216,null,0,1,null,t)),y._30(21,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,0,["\n                "])),(n()(),y._26(16777216,null,0,1,null,a)),y._30(24,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,0,["\n            "])),(n()(),y._55(-1,null,["\n            "])),(n()(),y._31(27,0,null,null,9,"core-context-menu",[],null,null,null,il.b,il.a)),y._30(28,245760,null,0,on.a,[cn.a,rl.a,y.t,P.a,[2,ul.a],Mn.a],null,null),(n()(),y._55(-1,0,["\n                "])),(n()(),y._26(16777216,null,0,1,null,i)),y._30(31,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,0,["\n                "])),(n()(),y._31(33,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,l,e){var t=!0;if("action"===l){t=!1!==n.component.doRefresh(null,e,!0)&&t}return t},rn.b,rn.a)),y._30(34,770048,null,0,un.a,[on.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,0,["\n            "])),(n()(),y._55(-1,null,["\n        "])),(n()(),y._55(-1,3,["\n    "])),(n()(),y._55(-1,null,["\n"])),(n()(),y._55(-1,null,["\n"])),(n()(),y._31(41,0,null,null,50,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,ol.b,ol.a)),y._30(42,4374528,null,0,An.a,[an.a,Pn.a,Yn.a,y.t,y.V,Zn.a,sl.a,y.M,[2,qn.a],[2,jn.a]],null,null),(n()(),y._55(-1,1,["\n    "])),(n()(),y._31(44,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(n,l,e){var t=!0;if("ionRefresh"===l){t=!1!==n.component.doRefresh(e)&&t}return t},null,null)),y._30(45,212992,null,0,cl.a,[Pn.a,An.a,y.M,Hn.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(n()(),y._55(-1,null,["\n        "])),(n()(),y._31(47,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,dl.b,dl.a)),y._30(48,114688,null,0,fl.a,[cl.a,an.a],{pullingText:[0,"pullingText"]},null),y._47(131072,sn.a,[cn.a,y.j]),(n()(),y._55(-1,null,["\n    "])),(n()(),y._55(-1,1,["\n\n    "])),(n()(),y._55(-1,1,["\n    "])),(n()(),y._31(53,0,null,1,19,"ion-grid",[["class","safe-area-page grid"],["padding-top",""]],null,null,null,null,null)),y._30(54,16384,null,0,_l.a,[],null,null),(n()(),y._55(-1,null,["\n        "])),(n()(),y._31(56,0,null,null,15,"ion-row",[["class","row"]],null,null,null,null,null)),y._30(57,16384,null,0,hl.a,[],null,null),(n()(),y._55(-1,null,["\n            "])),(n()(),y._26(16777216,null,null,1,null,r)),y._30(60,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,null,["\n            "])),(n()(),y._31(62,0,null,null,5,"ion-col",[["class","addon-calendar-period col"],["text-center",""]],null,null,null,null,null)),y._30(63,16384,null,0,dn.a,[],null,null),(n()(),y._55(-1,null,["\n                "])),(n()(),y._31(65,0,null,null,1,"h3",[],null,null,null,null,null)),(n()(),y._55(66,null,["",""])),(n()(),y._55(-1,null,["\n            "])),(n()(),y._55(-1,null,["\n            "])),(n()(),y._26(16777216,null,null,1,null,u)),y._30(70,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,null,["\n        "])),(n()(),y._55(-1,null,["\n    "])),(n()(),y._55(-1,1,["\n\n    "])),(n()(),y._31(74,0,null,1,16,"core-loading",[["class","safe-area-page"]],null,null,null,ml.b,ml.a)),y._30(75,638976,null,0,vl.a,[cn.a,y.t,C.a,Mn.a],{hideUntil:[0,"hideUntil"]},null),(n()(),y._55(-1,0,["\n        "])),(n()(),y._55(-1,0,["\n        "])),(n()(),y._26(16777216,null,0,1,null,o)),y._30(79,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,0,["\n\n        "])),(n()(),y._26(16777216,null,0,1,null,s)),y._30(82,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,0,["\n\n        "])),(n()(),y._26(16777216,null,0,1,null,m)),y._30(85,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,0,["\n\n        "])),(n()(),y._55(-1,0,["\n        "])),(n()(),y._26(16777216,null,0,1,null,v)),y._30(89,16384,null,0,bn.k,[y._11,y._6],{ngIf:[0,"ngIf"]},null),(n()(),y._55(-1,0,["\n    "])),(n()(),y._55(-1,1,["\n"])),(n()(),y._55(-1,null,["\n"]))],function(n,l){var e=l.component;n(l,5,0);n(l,21,0,e.filter.filtered);n(l,24,0,!e.filter.filtered),n(l,28,0);n(l,31,0,!e.isCurrentDay);n(l,34,0,y._56(l,34,0,y._44(l,35).transform("core.settings.synchronizenow")),e.syncIcon,!1,400,!e.loaded||!e.hasOffline||!e.isOnline);n(l,45,0,e.loaded);n(l,48,0,y._34(1,"",y._56(l,48,0,y._44(l,49).transform("core.pulltorefresh")),""));n(l,60,0,e.currentMoment);n(l,70,0,e.currentMoment);n(l,75,0,e.loaded);n(l,79,0,e.hasOffline);n(l,82,0,!e.filteredEvents||!e.filteredEvents.length);n(l,85,0,e.filteredEvents&&e.filteredEvents.length);n(l,89,0,e.canCreate)},function(n,l){var e=l.component;n(l,3,0,y._44(l,4)._hidden,y._44(l,4)._sbPadding);n(l,9,0,y._56(l,9,0,y._44(l,10).transform("addon.calendar.calendarevents")));n(l,16,0,y._56(l,16,0,y._44(l,18).transform("core.filter")));n(l,41,0,y._44(l,42).statusbarPadding,y._44(l,42)._hasRefresher);n(l,44,0,"inactive"!==y._44(l,45).state,y._44(l,45)._top);n(l,47,0,y._44(l,48).r.state);n(l,66,0,e.periodName)})}Object.defineProperty(l,"__esModule",{value:!0});var y=e(0),g=e(5),E=e(3),b=e(28),I=e(32),D=e(108),O=e(9),C=e(10),x=e(152),w=e(1),P=e(4),M=e(24),k=e(187),T=e(277),V=e(278),N=e(481),j=e(52),A=e(189),S=e(748),F=e(186),R=e(14),U=this&&this.__decorate||function(n,l,e,t){var a,i=arguments.length,r=i<3?l:null===t?t=Object.getOwnPropertyDescriptor(l,e):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(n,l,e,t);else for(var u=n.length-1;u>=0;u--)(a=n[u])&&(r=(i<3?a(r):i>3?a(l,e,r):a(l,e))||r);return i>3&&r&&Object.defineProperty(l,e,r),r},$=this&&this.__metadata||function(n,l){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,l)},L=function(){function n(n,l,e,t,a,i,r,u,o,s,c,d,f,_,h,m,v){var p=this;this.navCtrl=i,this.domUtils=r,this.timeUtils=u,this.calendarProvider=o,this.calendarOffline=s,this.calendarHelper=c,this.calendarSync=d,this.eventsProvider=f,this.coursesProvider=_,this.coursesHelper=h,this.appProvider=m,this.popoverCtrl=v,this.categories={},this.events=[],this.onlineEvents=[],this.offlineEvents={},this.offlineEditedEventsIds=[],this.deletedEvents=[],this.filteredEvents=[],this.canCreate=!1,this.loaded=!1,this.hasOffline=!1,this.isOnline=!1,this.filter={filtered:!1,courseId:null,categoryId:null,course:!0,group:!0,site:!0,user:!0,category:!0};var y=new Date;k.a.ALL_TYPES.forEach(function(n){p.filter[n]=l.get(n),p.filter[n]=void 0===p.filter[n]||p.filter[n]}),this.filter.courseId=l.get("courseId"),this.filter.categoryId=l.get("categoryId"),this.filter.filtered=!!this.filter.courseId||k.a.ALL_TYPES.some(function(n){return!p.filter[n]}),this.year=l.get("year")||y.getFullYear(),this.month=l.get("month")||y.getMonth()+1,this.day=l.get("day")||y.getDate(),this.currentSiteId=a.getCurrentSiteId(),n.isAvailable()&&(this.obsDefaultTimeChange=f.on(k.a.DEFAULT_NOTIFICATION_TIME_CHANGED,function(){o.scheduleEventsNotifications(p.onlineEvents)},this.currentSiteId)),this.newEventObserver=f.on(k.a.NEW_EVENT_EVENT,function(n){n&&n.event&&(p.loaded=!1,p.refreshData(!0,!1,!0))},this.currentSiteId),this.discardedObserver=f.on(k.a.NEW_EVENT_DISCARDED_EVENT,function(){p.loaded=!1,p.refreshData(!0,!1,!0)},this.currentSiteId),this.editEventObserver=f.on(k.a.EDIT_EVENT_EVENT,function(n){n&&n.event&&(p.loaded=!1,p.refreshData(!0,!1,!0))},this.currentSiteId),this.syncObserver=f.on(N.a.AUTO_SYNCED,function(n){p.loaded=!1,p.refreshData(!1,!1,!0)},this.currentSiteId),this.manualSyncObserver=f.on(N.a.MANUAL_SYNCED,function(n){!n||"day"==n.source&&n.year==p.year&&n.month==p.month&&n.day==p.day||(p.loaded=!1,p.refreshData(!1,!1,!0))},this.currentSiteId),this.deleteEventObserver=f.on(k.a.DELETED_EVENT_EVENT,function(n){n&&!n.sent?(p.hasOffline=p.markAsDeleted(n.eventId,!0)||p.hasOffline,p.deletedEvents.push(n.eventId)):(p.loaded=!1,p.refreshData(!1,!1,!0))},this.currentSiteId),this.undeleteEventObserver=f.on(k.a.UNDELETED_EVENT_EVENT,function(n){if(n&&n.eventId){var l=p.markAsDeleted(n.eventId,!1),e=p.deletedEvents.indexOf(n.eventId);if(-1!=e&&p.deletedEvents.splice(e,1),l)if(p.hasOffline=!1,p.events.length!=p.onlineEvents.length)p.hasOffline=!0;else{var t=p.events.find(function(n){return n.deleted||n.offline});p.hasOffline=!!t}}},this.currentSiteId),this.filterChangedObserver=this.eventsProvider.on(k.a.FILTER_CHANGED_EVENT,function(n){p.filter=n,p.calendarHelper.canEditEvents(p.filter.courseId).then(function(n){p.canCreate=n}),p.filterEvents()}),this.onlineObserver=e.onchange().subscribe(function(){t.run(function(){p.isOnline=p.appProvider.isOnline()})})}return n.prototype.ngOnInit=function(){this.calculateCurrentMoment(),this.calculateIsCurrentDay(),this.fetchData(!0,!1)},n.prototype.fetchData=function(n,l){var e=this;this.syncIcon="spinner",this.isOnline=this.appProvider.isOnline();return(n?this.sync():Promise.resolve()).then(function(){var n=[];return n.push(e.coursesHelper.getCoursesForPopover(e.filter.courseId).then(function(n){e.courses=n.courses})),n.push(e.loadCategories()),n.push(e.calendarOffline.getAllEditedEvents().then(function(n){n.forEach(function(n){n.offline=!0,e.calendarHelper.formatEventData(n)}),e.offlineEvents=e.calendarHelper.classifyIntoMonths(n);var l=n.filter(function(n){return n.id>0});e.offlineEditedEventsIds=l.map(function(n){return n.id})})),n.push(e.calendarOffline.getAllDeletedEventsIds().then(function(n){e.deletedEvents=n})),n.push(e.calendarHelper.canEditEvents(e.filter.courseId).then(function(n){e.canCreate=n})),n.push(e.calendarProvider.getCalendarTimeFormat().then(function(n){e.timeFormat=n})),Promise.all(n)}).then(function(){return e.fetchEvents()}).catch(function(n){e.domUtils.showErrorModalDefault(n,"addon.calendar.errorloadevents",!0)}).finally(function(){e.loaded=!0,e.syncIcon="sync"})},n.prototype.fetchEvents=function(){var n=this;return this.calendarProvider.getDayEvents(this.year,this.month,this.day).catch(function(l){return n.appProvider.isOnline()?Promise.reject(l):Promise.resolve({events:[]})}).then(function(l){var e=[];n.periodName=n.timeUtils.userDate(new Date(n.year,n.month-1,n.day).getTime(),"core.strftimedaydate"),n.onlineEvents=l.events,n.onlineEvents.forEach(n.calendarHelper.formatEventData.bind(n.calendarHelper)),n.calendarProvider.scheduleEventsNotifications(n.onlineEvents),n.events=n.mergeEvents(),n.filterEvents(),n.calculateIsCurrentDay();var t=1e3*n.currentMoment.unix();return n.events.forEach(function(l){l.ispast=n.isPastDay||n.isCurrentDay&&n.isEventPast(l),e.push(n.calendarProvider.formatEventTime(l,n.timeFormat,!0,t).then(function(n){l.formattedtime=n}))}),Promise.all(e)})},n.prototype.mergeEvents=function(){var n=this;if(this.hasOffline=!1,!Object.keys(this.offlineEvents).length&&!this.deletedEvents.length)return this.onlineEvents;var l=this.offlineEvents[this.calendarHelper.getMonthId(this.year,this.month)],e=l&&l[this.day],t=this.onlineEvents;return this.deletedEvents.length&&t.forEach(function(l){l.deleted=-1!=n.deletedEvents.indexOf(l.id),l.deleted&&(n.hasOffline=!0)}),this.offlineEditedEventsIds.length&&(t=t.filter(function(l){return-1==n.offlineEditedEventsIds.indexOf(l.id)})).length!=this.onlineEvents.length&&(this.hasOffline=!0),e&&e.length&&(this.hasOffline=!0,t=this.sortEvents(t.concat(e))),t},n.prototype.filterEvents=function(){this.filteredEvents=this.calendarHelper.getFilteredEvents(this.events,this.filter,this.categories)},n.prototype.sortEvents=function(n){return n.sort(function(n,l){return n.timestart==l.timestart?n.timeduration-l.timeduration:n.timestart-l.timestart})},n.prototype.doRefresh=function(n,l,e){return this.loaded?this.refreshData(!0,e).finally(function(){n&&n.complete(),l&&l()}):Promise.resolve()},n.prototype.refreshData=function(n,l,e){var t=this;this.syncIcon="spinner";var a=[];return e||a.push(this.calendarProvider.invalidateDayEvents(this.year,this.month,this.day)),a.push(this.calendarProvider.invalidateAllowedEventTypes()),a.push(this.coursesProvider.invalidateCategories(0,!0)),a.push(this.calendarProvider.invalidateTimeFormat()),Promise.all(a).finally(function(){return t.fetchData(n,l)})},n.prototype.loadCategories=function(){var n=this;return this.coursesProvider.getCategories(0,!0).then(function(l){n.categories={},l.forEach(function(l){n.categories[l.id]=l})}).catch(function(){})},n.prototype.sync=function(n){var l=this;return this.calendarSync.syncEvents().then(function(n){n.warnings&&n.warnings.length&&l.domUtils.showErrorModal(n.warnings[0]),n.updated&&(n.source="day",n.day=l.day,n.month=l.month,n.year=l.year,l.eventsProvider.trigger(N.a.MANUAL_SYNCED,n,l.currentSiteId))}).catch(function(e){n&&l.domUtils.showErrorModalDefault(e,"core.errorsync",!0)})},n.prototype.gotoEvent=function(n){n<0?this.openEdit(n):this.navCtrl.push("AddonCalendarEventPage",{id:n})},n.prototype.openFilter=function(n){this.popoverCtrl.create(S.a,{courses:this.courses,filter:this.filter}).present({ev:n})},n.prototype.openEdit=function(n){var l={};n?l.eventId=n:l.timestamp=1e3*R().year(this.year).month(this.month-1).date(this.day).unix(),this.filter.courseId&&(l.courseId=this.filter.courseId),this.navCtrl.push("AddonCalendarEditEventPage",l)},n.prototype.calculateCurrentMoment=function(){this.currentMoment=R().year(this.year).month(this.month-1).date(this.day)},n.prototype.calculateIsCurrentDay=function(){var n=new Date;this.currentTime=this.timeUtils.timestamp(),this.isCurrentDay=this.year==n.getFullYear()&&this.month==n.getMonth()+1&&this.day==n.getDate(),this.isPastDay=this.year<n.getFullYear()||this.year==n.getFullYear()&&this.month<n.getMonth()||this.year==n.getFullYear()&&this.month==n.getMonth()+1&&this.day<n.getDate()},n.prototype.goToCurrentDay=function(){var n=this,l=new Date,e=this.day,t=this.month,a=this.year;this.day=l.getDate(),this.month=l.getMonth()+1,this.year=l.getFullYear(),this.calculateCurrentMoment(),this.loaded=!1,this.fetchEvents().then(function(){n.isCurrentDay=!0}).catch(function(l){n.domUtils.showErrorModalDefault(l,"addon.calendar.errorloadevents",!0),n.year=a,n.month=t,n.day=e,n.calculateCurrentMoment()}).finally(function(){n.loaded=!0})},n.prototype.loadNext=function(){var n=this;this.increaseDay(),this.loaded=!1,this.fetchEvents().catch(function(l){n.domUtils.showErrorModalDefault(l,"addon.calendar.errorloadevents",!0),n.decreaseDay()}).finally(function(){n.loaded=!0})},n.prototype.loadPrevious=function(){var n=this;this.decreaseDay(),this.loaded=!1,this.fetchEvents().catch(function(l){n.domUtils.showErrorModalDefault(l,"addon.calendar.errorloadevents",!0),n.increaseDay()}).finally(function(){n.loaded=!0})},n.prototype.decreaseDay=function(){this.currentMoment.subtract(1,"day"),this.year=this.currentMoment.year(),this.month=this.currentMoment.month()+1,this.day=this.currentMoment.date()},n.prototype.increaseDay=function(){this.currentMoment.add(1,"day"),this.year=this.currentMoment.year(),this.month=this.currentMoment.month()+1,this.day=this.currentMoment.date()},n.prototype.markAsDeleted=function(n,l){var e=this.onlineEvents.find(function(l){return l.id==n});return!!e&&(e.deleted=l,!0)},n.prototype.isEventPast=function(n){return n.timestart+n.timeduration<this.currentTime},n.prototype.ngOnDestroy=function(){this.newEventObserver&&this.newEventObserver.off(),this.discardedObserver&&this.discardedObserver.off(),this.editEventObserver&&this.editEventObserver.off(),this.deleteEventObserver&&this.deleteEventObserver.off(),this.undeleteEventObserver&&this.undeleteEventObserver.off(),this.syncObserver&&this.syncObserver.off(),this.manualSyncObserver&&this.manualSyncObserver.off(),this.onlineObserver&&this.onlineObserver.unsubscribe(),this.filterChangedObserver&&this.filterChangedObserver.off(),this.obsDefaultTimeChange&&this.obsDefaultTimeChange.off()},n=U([Object(y.m)({selector:"page-addon-calendar-day",templateUrl:"day.html"}),$("design:paramtypes",[x.a,g.t,F.a,y.M,w.a,g.s,P.a,M.a,k.a,T.a,V.a,N.a,C.a,j.a,A.a,O.a,g.w])],n)}(),H=this&&this.__decorate||function(n,l,e,t){var a,i=arguments.length,r=i<3?l:null===t?t=Object.getOwnPropertyDescriptor(l,e):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(n,l,e,t);else for(var u=n.length-1;u>=0;u--)(a=n[u])&&(r=(i<3?a(r):i>3?a(l,e,r):a(l,e))||r);return i>3&&r&&Object.defineProperty(l,e,r),r},Y=function(){function n(){}return n=H([Object(y.I)({declarations:[L],imports:[b.a,I.a,D.a,g.l.forChild(L),E.b.forChild()]})],n)}(),G=e(1525),W=e(1526),z=e(1527),B=e(1528),J=e(1529),K=e(1530),q=e(1531),Q=e(1532),X=e(1533),Z=e(1534),nn=e(1535),ln=e(1536),en=e(1537),tn=e(47),an=e(8),rn=e(94),un=e(84),on=e(79),sn=e(25),cn=e(17),dn=e(120),fn=e(45),_n=e(41),hn=e(91),mn=e(126),vn=e(116),pn=e(90),yn=e(83),gn=e(251),En=e(30),bn=e(7),In=e(20),Dn=e(19),On=e(26),Cn=e(33),xn=e(48),wn=e(11),Pn=e(16),Mn=e(2),kn=e(22),Tn=e(6),Vn=e(18),Nn=e(15),jn=e(21),An=e(29),Sn=e(27),Fn=e(43),Rn=e(42),Un=e(31),$n=e(36),Ln=e(89),Hn=e(44),Yn=e(34),Gn=e(283),Wn=e(258),zn=e(218),Bn=e(284),Jn=e(191),Kn=e(374),qn=e(39),Qn=e(724),Xn=e(213),Zn=e(35),nl=e(477),ll=e(725),el=e(315),tl=e(250),al=e(375),il=e(93),rl=e(71),ul=e(77),ol=e(182),sl=e(109),cl=e(160),dl=e(214),fl=e(174),_l=e(165),hl=e(119),ml=e(54),vl=e(51),pl=e(70),yl=y._29({encapsulation:2,styles:[],data:{}}),gl=y._27("page-addon-calendar-day",L,function(n){return y._57(0,[(n()(),y._31(0,0,null,null,1,"page-addon-calendar-day",[],null,null,null,p,yl)),y._30(1,245760,null,0,L,[x.a,pl.a,F.a,y.M,w.a,jn.a,P.a,M.a,k.a,T.a,V.a,N.a,C.a,j.a,A.a,O.a,rl.a],null,null)],function(n,l){n(l,1,0)},null)},{},{},[]),El=e(23),bl=e(370),Il=e(371),Dl=e(373),Ol=e(372),Cl=e(476),xl=e(723),wl=e(273);e.d(l,"AddonCalendarDayPageModuleNgFactory",function(){return Pl});var Pl=y._28(Y,[],function(n){return y._40([y._41(512,y.o,y._21,[[8,[G.a,W.a,z.a,B.a,J.a,K.a,q.a,Q.a,X.a,Z.a,nn.a,ln.a,en.a,gl]],[3,y.o],y.K]),y._41(4608,bn.m,bn.l,[y.G,[2,bn.w]]),y._41(4608,El.x,El.x,[]),y._41(4608,El.d,El.d,[]),y._41(4608,bl.b,bl.a,[]),y._41(4608,Il.a,Il.b,[]),y._41(4608,Dl.b,Dl.a,[]),y._41(4608,Ol.b,Ol.a,[]),y._41(4608,cn.a,cn.a,[Cl.a,bl.b,Il.a,Dl.b,Ol.b,cn.b,cn.c]),y._41(512,bn.b,bn.b,[]),y._41(512,El.v,El.v,[]),y._41(512,El.i,El.i,[]),y._41(512,El.s,El.s,[]),y._41(512,xl.a,xl.a,[]),y._41(512,E.b,E.b,[]),y._41(512,I.a,I.a,[]),y._41(512,D.a,D.a,[]),y._41(512,b.a,b.a,[]),y._41(512,xl.b,xl.b,[]),y._41(512,Y,Y,[]),y._41(256,cn.c,void 0,[]),y._41(256,cn.b,void 0,[]),y._41(256,wl.a,L,[])])})}});