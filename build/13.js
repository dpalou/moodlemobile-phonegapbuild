webpackJsonp([13],{2116:function(n,l,t){"use strict";function u(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"core-icon",[["name","fa-map-pin"]],null,null,null,gl.b,gl.a)),z._30(1,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"fa-map-pin")},null)}function o(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"core-icon",[["class","addon-forum-star"],["name","fa-star"]],null,null,null,gl.b,gl.a)),z._30(1,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"fa-star")},null)}function e(n){return z._57(0,[(n()(),z._31(0,0,null,null,6,"ion-note",[["float-end",""],["padding-left",""],["text-end",""]],[[1,"aria-label",0]],null,null,null,null)),z._30(1,16384,null,0,Il.a,[zn.a,z.t,z.V],null,null),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._31(4,0,null,null,1,"core-icon",[["color","primary"],["name","fa-circle"]],null,null,null,gl.b,gl.a)),z._30(5,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"],color:[1,"color"]},null),(n()(),z._55(-1,null,["\n                "]))],function(n,l){n(l,5,0,"fa-circle","primary")},function(n,l){n(l,0,0,z._56(l,0,0,z._44(l,2).transform("addon.mod_forum.unread")))})}function a(n){return z._57(0,[(n()(),z._31(0,0,null,null,6,"button",[["clear",""],["color","dark"],["icon-only",""],["ion-button",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,l,t){var u=!0;if("click"===l){u=!1!==n.component.showOptionsMenu(t)&&u}return u},vl.b,vl.a)),z._30(1,1097728,[[2,4]],0,bl.a,[[8,""],zn.a,z.t,z.V],{color:[0,"color"],clear:[1,"clear"]},null),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n                    "])),(n()(),z._31(4,0,null,0,1,"core-icon",[["name","more"]],null,null,null,gl.b,gl.a)),z._30(5,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"]},null),(n()(),z._55(-1,0,["\n                "]))],function(n,l){n(l,1,0,"dark","");n(l,5,0,"more")},function(n,l){n(l,0,0,z._56(l,0,0,z._44(l,2).transform("core.displayoptions")))})}function i(n){return z._57(0,[(n()(),z._31(0,0,null,null,19,"div",[["class","addon-mod-forum-post-title"]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n                "])),(n()(),z._31(2,0,null,null,10,"h2",[["text-wrap",""]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._26(16777216,null,null,1,null,u)),z._30(5,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._26(16777216,null,null,1,null,o)),z._30(8,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._31(10,16777216,null,null,1,"core-format-text",[["contextLevel","module"]],null,null,null,null,null)),z._30(11,540672,null,0,Jn.a,[z.t,tn.a,un.a,Qn.a,Xn.a,Zn.a,on.a,nl.a,ll.a,tl.a,nn.a,ul.a,[2,ol.a],[2,el.a],[2,sn.a],al.a,ln.a,il.a,sl.a,rl.a,z._11],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"],courseId:[3,"courseId"]},null),(n()(),z._55(-1,null,["\n                "])),(n()(),z._55(-1,null,["\n                "])),(n()(),z._26(16777216,null,null,1,null,e)),z._30(15,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                "])),(n()(),z._26(16777216,null,null,1,null,a)),z._30(18,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n            "]))],function(n,l){var t=l.component;n(l,5,0,0==t.post.parent&&t.post.pinned);n(l,8,0,0==t.post.parent&&!t.post.pinned&&t.post.starred);n(l,11,0,t.post.subject,"module",t.forum&&t.forum.cmid,t.courseId);n(l,15,0,t.trackPosts&&!t.post.postread);n(l,18,0,t.optionsMenuEnabled)},null)}function s(n){return z._57(0,[(n()(),z._31(0,0,null,null,2,"ion-avatar",[["core-user-avatar",""],["item-start",""]],null,null,null,Pl.b,Pl.a)),z._30(1,16384,null,0,kl.a,[],null,null),z._30(2,770048,null,0,Cl.a,[ol.a,tn.a,on.a,nn.a,ln.a,[2,sn.a]],{user:[0,"user"],courseId:[1,"courseId"]},null)],function(n,l){var t=l.component;n(l,2,0,t.post,t.courseId)},null)}function r(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"h3",[],null,null,null,null,null)),(n()(),z._55(1,null,["",""]))],null,function(n,l){n(l,1,0,l.component.post.userfullname)})}function c(n){return z._57(0,[(n()(),z._31(0,0,null,null,3,"p",[],null,null,null,null,null)),(n()(),z._31(1,0,null,null,1,"ion-icon",[["name","people"],["role","img"]],[[2,"hide",null]],null,null,null,null)),z._30(2,147456,[[3,4]],0,pl.a,[zn.a,z.t,z.V],{name:[0,"name"]},null),(n()(),z._55(3,null,[" ",""]))],function(n,l){n(l,2,0,"people")},function(n,l){var t=l.component;n(l,1,0,z._44(l,2)._hidden);n(l,3,0,t.post.groupname)})}function d(n){return z._57(0,[(n()(),z._31(0,0,null,null,2,"p",[],null,null,null,null,null)),(n()(),z._55(1,null,["",""])),z._49(2,2)],null,function(n,l){var t=l.component;n(l,1,0,z._56(l,1,0,n(l,2,0,z._44(l.parent,0),1e3*t.post.modified,"strftimerecentfull")))})}function _(n){return z._57(0,[(n()(),z._31(0,0,null,null,4,"p",[],null,null,null,null,null)),(n()(),z._31(1,0,null,null,1,"ion-icon",[["name","time"],["role","img"]],[[2,"hide",null]],null,null,null,null)),z._30(2,147456,[[3,4]],0,pl.a,[zn.a,z.t,z.V],{name:[0,"name"]},null),(n()(),z._55(3,null,[" ",""])),z._47(131072,fl.a,[Xn.a,z.j])],function(n,l){n(l,2,0,"time")},function(n,l){n(l,1,0,z._44(l,2)._hidden);n(l,3,0,z._56(l,3,0,z._44(l,4).transform("core.notsent")))})}function f(n){return z._57(0,[(n()(),z._31(0,0,null,null,6,"ion-note",[["float-end",""],["padding-left",""],["text-end",""]],[[1,"aria-label",0]],null,null,null,null)),z._30(1,16384,null,0,Il.a,[zn.a,z.t,z.V],null,null),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,null,["\n                        "])),(n()(),z._31(4,0,null,null,1,"core-icon",[["color","primary"],["name","fa-circle"]],null,null,null,gl.b,gl.a)),z._30(5,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"],color:[1,"color"]},null),(n()(),z._55(-1,null,["\n                    "]))],function(n,l){n(l,5,0,"fa-circle","primary")},function(n,l){n(l,0,0,z._56(l,0,0,z._44(l,2).transform("addon.mod_forum.unread")))})}function m(n){return z._57(0,[(n()(),z._31(0,0,null,null,6,"button",[["clear",""],["color","dark"],["icon-only",""],["ion-button",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,l,t){var u=!0;if("click"===l){u=!1!==n.component.showOptionsMenu(t)&&u}return u},vl.b,vl.a)),z._30(1,1097728,[[2,4]],0,bl.a,[[8,""],zn.a,z.t,z.V],{color:[0,"color"],clear:[1,"clear"]},null),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n                        "])),(n()(),z._31(4,0,null,0,1,"core-icon",[["name","more"]],null,null,null,gl.b,gl.a)),z._30(5,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"]},null),(n()(),z._55(-1,0,["\n                    "]))],function(n,l){n(l,1,0,"dark","");n(l,5,0,"more")},function(n,l){n(l,0,0,z._56(l,0,0,z._44(l,2).transform("core.displayoptions")))})}function p(n){return z._57(0,[(n()(),z._31(0,0,null,null,7,null,null,null,null,null,null,null)),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._26(16777216,null,null,1,null,f)),z._30(3,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._26(16777216,null,null,1,null,m)),z._30(6,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                "]))],function(n,l){var t=l.component;n(l,3,0,t.trackPosts&&!t.post.postread);n(l,6,0,t.optionsMenuEnabled)},null)}function g(n){return z._57(0,[(n()(),z._31(0,0,null,null,6,"div",[["padding-bottom",""]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n            "])),(n()(),z._31(2,0,null,null,3,"ion-note",[["color","danger"]],null,null,null,null,null)),z._30(3,16384,null,0,Il.a,[zn.a,z.t,z.V],{color:[0,"color"]},null),(n()(),z._55(4,null,["",""])),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,null,["\n        "]))],function(n,l){n(l,3,0,"danger")},function(n,l){n(l,4,0,z._56(l,4,0,z._44(l,5).transform("addon.mod_forum.postisprivatereply")))})}function h(n){return z._57(0,[(n()(),z._31(0,0,null,null,4,"div",[["no-lines",""]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n            "])),(n()(),z._31(2,0,null,null,1,"core-files",[["showInline","true"]],null,null,null,Sl.b,Sl.a)),z._30(3,376832,null,0,xl.a,[Ol.a,on.a,z.F],{files:[0,"files"],component:[1,"component"],componentId:[2,"componentId"],showInline:[3,"showInline"]},null),(n()(),z._55(-1,null,["\n        "]))],function(n,l){var t=l.component;n(l,3,0,t.post.attachments,t.component,t.componentId,"true")},null)}function I(n){return z._57(0,[(n()(),z._31(0,0,null,null,13,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,Dl.b,Dl.a)),z._30(1,1097728,null,3,jl.a,[wl.a,zn.a,z.t,z.V,[2,Ll.a]],null,null),z._52(335544320,4,{contentLabel:0}),z._52(603979776,5,{_buttons:1}),z._52(603979776,6,{_icons:1}),z._30(5,16384,null,0,Vl.a,[],null,null),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(7,0,null,0,2,"div",[["item-start",""]],null,null,null,null,null)),(n()(),z._55(8,null,["",":"])),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(11,0,null,2,1,"core-tag-list",[],null,null,null,Al.b,Al.a)),z._30(12,49152,null,0,El.a,[ol.a,[2,sn.a]],{tags:[0,"tags"]},null),(n()(),z._55(-1,2,["\n        "]))],function(n,l){n(l,12,0,l.component.post.tags)},function(n,l){n(l,8,0,z._56(l,8,0,z._44(l,9).transform("core.tag.tags")))})}function v(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"core-rating-rate",[["contextLevel","module"]],null,[[null,"onUpdate"]],function(n,l,t){var u=!0;if("onUpdate"===l){u=!1!==n.component.ratingUpdated()&&u}return u},Ml.b,Ml.a)),z._30(1,704512,null,0,Ul.a,[un.a,Xn.a,ln.a,rn.a,cn.a,tn.a],{ratingInfo:[0,"ratingInfo"],contextLevel:[1,"contextLevel"],instanceId:[2,"instanceId"],itemId:[3,"itemId"],itemSetId:[4,"itemSetId"],courseId:[5,"courseId"],aggregateMethod:[6,"aggregateMethod"],scaleId:[7,"scaleId"],userId:[8,"userId"]},{onUpdate:"onUpdate"})],function(n,l){var t=l.component;n(l,1,0,t.ratingInfo,"module",t.componentId,t.post.id,t.discussionId,t.courseId,t.forum.assessed,t.forum.scale,t.post.userid)},null)}function b(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"core-rating-aggregate",[["contextLevel","module"]],null,null,null,Tl.b,Tl.a)),z._30(1,704512,null,0,Rl.a,[ln.a,Nl.a,rn.a,tn.a],{ratingInfo:[0,"ratingInfo"],contextLevel:[1,"contextLevel"],instanceId:[2,"instanceId"],itemId:[3,"itemId"],aggregateMethod:[4,"aggregateMethod"],scaleId:[5,"scaleId"],courseId:[6,"courseId"]},null)],function(n,l){var t=l.component;n(l,1,0,t.ratingInfo,"module",t.componentId,t.post.id,t.forum.assessed,t.forum.scale,t.courseId)},null)}function y(n){return z._57(0,[(n()(),z._31(0,0,null,null,14,"ion-item",[["class","addon-forum-reply-button item item-block"],["no-padding",""],["text-end",""]],null,null,null,Dl.b,Dl.a)),z._30(1,1097728,null,3,jl.a,[wl.a,zn.a,z.t,z.V,[2,Ll.a]],null,null),z._52(335544320,7,{contentLabel:0}),z._52(603979776,8,{_buttons:1}),z._52(603979776,9,{_icons:1}),z._30(5,16384,null,0,Vl.a,[],null,null),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(7,0,null,2,6,"button",[["clear",""],["icon-left",""],["ion-button",""],["small",""]],[[1,"aria-controls",0],[1,"aria-expanded",0]],[[null,"click"]],function(n,l,t){var u=!0;if("click"===l){u=!1!==n.component.showReplyForm()&&u}return u},vl.b,vl.a)),z._30(8,1097728,[[8,4]],0,bl.a,[[8,""],zn.a,z.t,z.V],{small:[0,"small"],clear:[1,"clear"]},null),(n()(),z._55(-1,0,["\n                "])),(n()(),z._31(10,0,null,0,1,"core-icon",[["name","fa-reply"]],null,null,null,gl.b,gl.a)),z._30(11,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"]},null),(n()(),z._55(12,0,[" ","\n            "])),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,2,["\n        "]))],function(n,l){n(l,8,0,"","");n(l,11,0,"fa-reply")},function(n,l){var t=l.component;n(l,7,0,"addon-forum-reply-edit-form-"+t.uniqueId,t.replyData.replyingTo===t.post.id);n(l,12,0,z._56(l,12,0,z._44(l,13).transform("addon.mod_forum.reply")))})}function P(n){return z._57(0,[(n()(),z._31(0,0,null,null,18,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,Dl.b,Dl.a)),z._30(1,1097728,null,3,jl.a,[wl.a,zn.a,z.t,z.V,[2,Ll.a]],null,null),z._52(335544320,16,{contentLabel:0}),z._52(603979776,17,{_buttons:1}),z._52(603979776,18,{_icons:1}),z._30(5,16384,null,0,Vl.a,[],null,null),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(7,0,null,1,3,"ion-label",[],null,null,null,null,null)),z._30(8,16384,[[16,4]],0,Fl.a,[zn.a,z.t,z.V,[8,null],[8,null],[8,null],[8,null]],null,null),(n()(),z._55(9,null,["",""])),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(12,0,null,4,5,"ion-checkbox",[["item-end",""]],[[2,"checkbox-disabled",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"]],function(n,l,t){var u=!0,o=n.component;if("click"===l){u=!1!==z._44(n,13)._click(t)&&u}if("ngModelChange"===l){u=!1!==(o.replyData.isprivatereply=t)&&u}return u},Hl.b,Hl.a)),z._30(13,1228800,null,0,ql.a,[zn.a,wl.a,[2,jl.a],z.t,z.V],null,null),z._50(1024,null,$l.l,function(n){return[n]},[ql.a]),z._30(15,671744,null,0,$l.q,[[8,null],[8,null],[8,null],[2,$l.l]],{model:[0,"model"]},{update:"ngModelChange"}),z._50(2048,null,$l.m,null,[$l.q]),z._30(17,16384,null,0,$l.n,[$l.m],null,null),(n()(),z._55(-1,2,["\n        "]))],function(n,l){n(l,15,0,l.component.replyData.isprivatereply)},function(n,l){n(l,9,0,z._56(l,9,0,z._44(l,10).transform("addon.mod_forum.privatereply")));n(l,12,0,z._44(l,13)._disabled,z._44(l,17).ngClassUntouched,z._44(l,17).ngClassTouched,z._44(l,17).ngClassPristine,z._44(l,17).ngClassDirty,z._44(l,17).ngClassValid,z._44(l,17).ngClassInvalid,z._44(l,17).ngClassPending)})}function k(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"core-icon",[["item-start",""],["name","fa-caret-right"]],null,null,null,gl.b,gl.a)),z._30(1,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"fa-caret-right")},null)}function C(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"core-icon",[["item-start",""],["name","fa-caret-down"]],null,null,null,gl.b,gl.a)),z._30(1,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"fa-caret-down")},null)}function S(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"core-attachments",[],null,null,null,Gl.b,Gl.a)),z._30(1,114688,null,0,Yl.a,[nn.a,un.a,Qn.a,en.a,Xn.a,Kl.a],{files:[0,"files"],maxSize:[1,"maxSize"],maxSubmissions:[2,"maxSubmissions"],component:[3,"component"],componentId:[4,"componentId"],allowOffline:[5,"allowOffline"]},null)],function(n,l){var t=l.component;n(l,1,0,t.replyData.files,t.forum.maxbytes,t.forum.maxattachments,t.component,t.forum.cmid,!0)},null)}function x(n){return z._57(0,[(n()(),z._31(0,0,null,null,4,null,null,null,null,null,null,null)),(n()(),z._55(-1,null,["\n            "])),(n()(),z._26(16777216,null,null,1,null,S)),z._30(3,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n        "]))],function(n,l){var t=l.component;n(l,3,0,t.forum.id&&t.forum.maxattachments>0)},null)}function O(n){return z._57(0,[(n()(),z._31(0,0,null,null,87,"ion-list",[],[[8,"id",0]],null,null,null,null)),z._30(1,16384,null,0,zl.a,[zn.a,z.t,z.V,Zn.a,Bl.l,Wl.a],null,null),(n()(),z._55(-1,null,["\n        "])),(n()(),z._31(3,0,null,null,18,"ion-item",[["class","item item-block"]],null,null,null,Dl.b,Dl.a)),z._30(4,1097728,null,3,jl.a,[wl.a,zn.a,z.t,z.V,[2,Ll.a]],null,null),z._52(335544320,10,{contentLabel:0}),z._52(603979776,11,{_buttons:1}),z._52(603979776,12,{_icons:1}),z._30(8,16384,null,0,Vl.a,[],null,null),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(10,0,null,1,3,"ion-label",[["stacked",""]],null,null,null,null,null)),z._30(11,16384,[[10,4]],0,Fl.a,[zn.a,z.t,z.V,[8,null],[8,""],[8,null],[8,null]],null,null),(n()(),z._55(12,null,["",""])),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(15,0,null,3,5,"ion-input",[["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(n,l,t){var u=!0;if("ngModelChange"===l){u=!1!==(n.component.replyData.subject=t)&&u}return u},Jl.b,Jl.a)),z._30(16,671744,null,0,$l.q,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),z._50(2048,null,$l.m,null,[$l.q]),z._30(18,16384,null,0,$l.n,[$l.m],null,null),z._30(19,5423104,null,0,Ql.a,[zn.a,Zn.a,wl.a,Xl.a,z.t,z.V,[2,el.a],[2,jl.a],[2,$l.m],Wl.a],{type:[0,"type"],placeholder:[1,"placeholder"]},null),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,2,["\n        "])),(n()(),z._55(-1,null,["\n        "])),(n()(),z._31(23,0,null,null,16,"ion-item",[["class","item item-block"]],null,null,null,Dl.b,Dl.a)),z._30(24,1097728,null,3,jl.a,[wl.a,zn.a,z.t,z.V,[2,Ll.a]],null,null),z._52(335544320,13,{contentLabel:0}),z._52(603979776,14,{_buttons:1}),z._52(603979776,15,{_icons:1}),z._30(28,16384,null,0,Vl.a,[],null,null),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(30,0,null,1,3,"ion-label",[["stacked",""]],null,null,null,null,null)),z._30(31,16384,[[13,4]],0,Fl.a,[zn.a,z.t,z.V,[8,null],[8,""],[8,null],[8,null]],null,null),(n()(),z._55(32,null,["",""])),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(35,0,null,3,3,"core-rich-text-editor",[["contextLevel","module"],["elementId","message"],["item-content",""]],null,[[null,"contentChanged"]],function(n,l,t){var u=!0;if("contentChanged"===l){u=!1!==n.component.onMessageChange(t)&&u}return u},Hn.c,Hn.b)),z._30(36,1228800,null,0,Zl.a,[un.a,nl.a,tn.a,tl.a,[2,el.a],z.t,ln.a,on.a,Zn.a,nt.a],{placeholder:[0,"placeholder"],control:[1,"control"],name:[2,"name"],component:[3,"component"],componentId:[4,"componentId"],autoSave:[5,"autoSave"],contextLevel:[6,"contextLevel"],contextInstanceId:[7,"contextInstanceId"],elementId:[8,"elementId"],draftExtraParams:[9,"draftExtraParams"]},{contentChanged:"contentChanged"}),z._47(131072,fl.a,[Xn.a,z.j]),z._48(38,{reply:0}),(n()(),z._55(-1,2,["\n        "])),(n()(),z._55(-1,null,["\n        "])),(n()(),z._26(16777216,null,null,1,null,P)),z._30(42,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n        "])),(n()(),z._31(44,0,null,null,13,"ion-item-divider",[["class","core-expandable item item-divider"],["text-wrap",""]],null,[[null,"click"]],function(n,l,t){var u=!0;if("click"===l){u=!1!==n.component.toggleAdvanced()&&u}return u},Dl.b,Dl.a)),z._30(45,1097728,null,3,jl.a,[wl.a,zn.a,z.t,z.V,[2,Ll.a]],null,null),z._52(335544320,19,{contentLabel:0}),z._52(603979776,20,{_buttons:1}),z._52(603979776,21,{_icons:1}),z._30(49,16384,null,0,lt.a,[zn.a,z.t,z.V],null,null),(n()(),z._55(-1,2,["\n            "])),(n()(),z._26(16777216,null,0,1,null,k)),z._30(52,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,2,["\n            "])),(n()(),z._26(16777216,null,0,1,null,C)),z._30(55,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(56,2,["\n            ","\n        "])),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,null,["\n        "])),(n()(),z._26(16777216,null,null,1,null,x)),z._30(60,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n        "])),(n()(),z._31(62,0,null,null,24,"ion-grid",[["class","grid"]],null,null,null,null,null)),z._30(63,16384,null,0,tt.a,[],null,null),(n()(),z._55(-1,null,["\n            "])),(n()(),z._31(65,0,null,null,20,"ion-row",[["class","row"]],null,null,null,null,null)),z._30(66,16384,null,0,ut.a,[],null,null),(n()(),z._55(-1,null,["\n                "])),(n()(),z._31(68,0,null,null,7,"ion-col",[["class","col"]],null,null,null,null,null)),z._30(69,16384,null,0,ot.a,[],null,null),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._31(71,0,null,null,3,"button",[["block",""],["ion-button",""]],[[8,"disabled",0]],[[null,"click"]],function(n,l,t){var u=!0;if("click"===l){u=!1!==n.component.reply()&&u}return u},vl.b,vl.a)),z._30(72,1097728,null,0,bl.a,[[8,""],zn.a,z.t,z.V],{block:[0,"block"]},null),(n()(),z._55(73,0,["",""])),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,null,["\n                "])),(n()(),z._55(-1,null,["\n                "])),(n()(),z._31(77,0,null,null,7,"ion-col",[["class","col"]],null,null,null,null,null)),z._30(78,16384,null,0,ot.a,[],null,null),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._31(80,0,null,null,3,"button",[["block",""],["color","light"],["ion-button",""]],null,[[null,"click"]],function(n,l,t){var u=!0;if("click"===l){u=!1!==n.component.cancel()&&u}return u},vl.b,vl.a)),z._30(81,1097728,null,0,bl.a,[[8,""],zn.a,z.t,z.V],{color:[0,"color"],block:[1,"block"]},null),(n()(),z._55(82,0,["",""])),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,null,["\n                "])),(n()(),z._55(-1,null,["\n            "])),(n()(),z._55(-1,null,["\n        "])),(n()(),z._55(-1,null,["\n    "]))],function(n,l){var t=l.component;n(l,16,0,t.replyData.subject);n(l,19,0,"text",z._56(l,19,1,z._44(l,20).transform("addon.mod_forum.subject")));n(l,36,0,z._56(l,36,0,z._44(l,37).transform("addon.mod_forum.replyplaceholder")),t.messageControl,"mod_forum_reply_"+t.post.id,t.component,t.componentId,!0,"module",t.forum&&t.forum.cmid,"message",n(l,38,0,t.post.id));n(l,42,0,t.accessInfo.canpostprivatereply);n(l,52,0,!t.advanced);n(l,55,0,t.advanced);n(l,60,0,t.advanced);n(l,72,0,"");n(l,81,0,"light","")},function(n,l){var t=l.component;n(l,0,0,"addon-forum-reply-edit-form-"+t.uniqueId);n(l,12,0,z._56(l,12,0,z._44(l,13).transform("addon.mod_forum.subject")));n(l,15,0,z._44(l,18).ngClassUntouched,z._44(l,18).ngClassTouched,z._44(l,18).ngClassPristine,z._44(l,18).ngClassDirty,z._44(l,18).ngClassValid,z._44(l,18).ngClassInvalid,z._44(l,18).ngClassPending);n(l,32,0,z._56(l,32,0,z._44(l,33).transform("addon.mod_forum.message")));n(l,56,0,z._56(l,56,0,z._44(l,57).transform("addon.mod_forum.advanced")));n(l,71,0,""==t.replyData.subject||null==t.replyData.message);n(l,73,0,z._56(l,73,0,z._44(l,74).transform("addon.mod_forum.posttoforum")));n(l,82,0,z._56(l,82,0,z._44(l,83).transform("core.cancel")))})}function D(n){return z._57(0,[z._47(0,et.a,[ll.a,at.a]),(n()(),z._31(1,0,null,null,71,"div",[["class","addon-mod_forum-post"]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n    "])),(n()(),z._31(3,0,null,null,37,"ion-card-header",[["no-padding",""],["text-wrap",""]],[[8,"id",0]],null,null,null,null)),z._30(4,16384,null,0,it.a,[zn.a,z.t,z.V],null,null),(n()(),z._55(-1,null,["\n        "])),(n()(),z._31(6,0,null,null,33,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,Dl.b,Dl.a)),z._30(7,1097728,null,3,jl.a,[wl.a,zn.a,z.t,z.V,[2,Ll.a]],null,null),z._52(335544320,1,{contentLabel:0}),z._52(603979776,2,{_buttons:1}),z._52(603979776,3,{_icons:1}),z._30(11,16384,null,0,Vl.a,[],null,null),(n()(),z._55(-1,2,["\n            "])),(n()(),z._26(16777216,null,2,1,null,i)),z._30(14,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,2,["\n            "])),(n()(),z._31(16,0,null,2,22,"div",[["class","addon-mod-forum-post-info"]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n                "])),(n()(),z._26(16777216,null,null,1,null,s)),z._30(19,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                "])),(n()(),z._31(21,0,null,null,13,"div",[["class","addon-mod-forum-post-author"]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._26(16777216,null,null,1,null,r)),z._30(24,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._26(16777216,null,null,1,null,c)),z._30(27,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._26(16777216,null,null,1,null,d)),z._30(30,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._26(16777216,null,null,1,null,_)),z._30(33,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                "])),(n()(),z._55(-1,null,["\n                "])),(n()(),z._26(16777216,null,null,1,null,p)),z._30(37,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n            "])),(n()(),z._55(-1,2,["\n        "])),(n()(),z._55(-1,null,["\n    "])),(n()(),z._55(-1,null,["\n    "])),(n()(),z._31(42,0,null,null,11,"ion-card-content",[],[[1,"padding-top",0]],null,null,null,null)),z._30(43,16384,null,0,st.a,[zn.a,z.t,z.V],null,null),(n()(),z._55(-1,null,["\n        "])),(n()(),z._26(16777216,null,null,1,null,g)),z._30(46,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n        "])),(n()(),z._31(48,16777216,null,null,1,"core-format-text",[["contextLevel","module"]],null,null,null,null,null)),z._30(49,540672,null,0,Jn.a,[z.t,tn.a,un.a,Qn.a,Xn.a,Zn.a,on.a,nl.a,ll.a,tl.a,nn.a,ul.a,[2,ol.a],[2,el.a],[2,sn.a],al.a,ln.a,il.a,sl.a,rl.a,z._11],{text:[0,"text"],component:[1,"component"],componentId:[2,"componentId"],contextLevel:[3,"contextLevel"],contextInstanceId:[4,"contextInstanceId"],courseId:[5,"courseId"]},null),(n()(),z._55(-1,null,["\n        "])),(n()(),z._26(16777216,null,null,1,null,h)),z._30(52,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n    "])),(n()(),z._55(-1,null,["\n    "])),(n()(),z._31(55,0,null,null,13,"div",[["class","addon-mod-forum-post-more-info"]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n        "])),(n()(),z._26(16777216,null,null,1,null,I)),z._30(58,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n        "])),(n()(),z._26(16777216,null,null,1,null,v)),z._30(61,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n        "])),(n()(),z._26(16777216,null,null,1,null,b)),z._30(64,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n\n        "])),(n()(),z._26(16777216,null,null,1,null,y)),z._30(67,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n    "])),(n()(),z._55(-1,null,["\n\n    "])),(n()(),z._26(16777216,null,null,1,null,O)),z._30(71,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n"])),(n()(),z._55(-1,null,["\n"]))],function(n,l){var t=l.component;n(l,14,0,t.displaySubject);n(l,19,0,t.post.userfullname);n(l,24,0,t.post.userfullname);n(l,27,0,t.post.groupname);n(l,30,0,t.post.modified);n(l,33,0,!t.post.modified);n(l,37,0,!t.displaySubject);n(l,46,0,t.post.isprivatereply);n(l,49,0,t.post.message,t.component,t.componentId,"module",t.forum&&t.forum.cmid,t.courseId);n(l,52,0,t.post.attachments&&t.post.attachments.length>0);n(l,58,0,t.tagsEnabled&&t.post.tags&&t.post.tags.length>0);n(l,61,0,t.forum&&t.ratingInfo);n(l,64,0,t.forum&&t.ratingInfo);n(l,67,0,t.post.id&&t.post.canreply&&!t.post.isprivatereply);n(l,71,0,t.post.id&&!t.replyData.isEditing&&t.replyData.replyingTo==t.post.id||!t.post.id&&t.replyData.isEditing&&t.replyData.replyingTo==t.post.parent)},function(n,l){var t=l.component;n(l,3,0,z._34(1,"addon-mod_forum-post-",t.post.id,""));n(l,42,0,0==t.post.parent||null)})}function j(n){return z._57(0,[(n()(),z._31(0,0,null,null,3,"ion-title",[],null,null,null,Yn.b,Yn.a)),z._30(1,49152,null,0,Kn.a,[zn.a,z.t,z.V,[2,Bn.a],[2,Wn.a]],null,null),(n()(),z._31(2,16777216,null,0,1,"core-format-text",[["contextLevel","module"]],null,null,null,null,null)),z._30(3,540672,null,0,Jn.a,[z.t,tn.a,un.a,Qn.a,Xn.a,Zn.a,on.a,nl.a,ll.a,tl.a,nn.a,ul.a,[2,ol.a],[2,el.a],[2,sn.a],al.a,ln.a,il.a,sl.a,rl.a,z._11],{text:[0,"text"],contextLevel:[1,"contextLevel"],contextInstanceId:[2,"contextInstanceId"],courseId:[3,"courseId"]},null)],function(n,l){var t=l.component;n(l,3,0,t.discussion.subject,"module",t.cmId,t.courseId)},null)}function w(n){return z._57(0,[(n()(),z._31(0,0,null,null,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.doRefresh(null,t)&&u}return u},cl.b,cl.a)),z._30(1,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j])],function(n,l){var t=l.component;n(l,1,0,z._56(l,1,0,z._44(l,2).transform("addon.mod_forum.refreshposts")),t.refreshIcon,!1,650)},null)}function L(n){return z._57(0,[(n()(),z._31(0,0,null,null,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.doRefresh(null,t,!0)&&u}return u},cl.b,cl.a)),z._30(1,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j])],function(n,l){var t=l.component;n(l,1,0,z._56(l,1,0,z._44(l,2).transform("core.settings.synchronizenow")),t.syncIcon,!1,550)},null)}function V(n){return z._57(0,[(n()(),z._31(0,0,null,null,7,"ion-card",[["class","core-warning-card"]],null,null,null,null,null)),z._30(1,16384,null,0,ml.a,[zn.a,z.t,z.V],null,null),(n()(),z._55(-1,null,["\n            "])),(n()(),z._31(3,0,null,null,1,"ion-icon",[["name","warning"],["role","img"]],[[2,"hide",null]],null,null,null,null)),z._30(4,147456,null,0,pl.a,[zn.a,z.t,z.V],{name:[0,"name"]},null),(n()(),z._55(5,null,[" ","\n        "])),z._48(6,{$a:0}),z._47(131072,fl.a,[Xn.a,z.j])],function(n,l){n(l,4,0,"warning")},function(n,l){var t=l.component;n(l,3,0,z._44(l,4)._hidden);n(l,5,0,z._56(l,5,0,z._44(l,7).transform("core.hasdatatosync",n(l,6,0,t.discussionStr))))})}function A(n){return z._57(0,[(n()(),z._31(0,0,null,null,5,"ion-card",[["class","core-info-card"],["icon-start",""]],null,null,null,null,null)),z._30(1,16384,null,0,ml.a,[zn.a,z.t,z.V],null,null),(n()(),z._55(-1,null,["\n            "])),(n()(),z._31(3,0,null,null,1,"ion-icon",[["name","information-circle"],["role","img"]],[[2,"hide",null]],null,null,null,null)),z._30(4,147456,null,0,pl.a,[zn.a,z.t,z.V],{name:[0,"name"]},null),(n()(),z._55(5,null,[" ","\n        "]))],function(n,l){n(l,4,0,"information-circle")},function(n,l){var t=l.component;n(l,3,0,z._44(l,4)._hidden);n(l,5,0,t.availabilityMessage)})}function E(n){return z._57(0,[(n()(),z._31(0,0,null,null,6,"ion-card",[["class","core-info-card"],["icon-start",""]],null,null,null,null,null)),z._30(1,16384,null,0,ml.a,[zn.a,z.t,z.V],null,null),(n()(),z._55(-1,null,["\n            "])),(n()(),z._31(3,0,null,null,1,"core-icon",[["name","fa-lock"]],null,null,null,gl.b,gl.a)),z._30(4,704512,null,0,hl.a,[z.t,zn.a],{name:[0,"name"]},null),(n()(),z._55(5,null,[" ","\n        "])),z._47(131072,fl.a,[Xn.a,z.j])],function(n,l){n(l,4,0,"fa-lock")},function(n,l){n(l,5,0,z._56(l,5,0,z._44(l,6).transform("addon.mod_forum.discussionlocked")))})}function M(n){return z._57(0,[(n()(),z._31(0,0,null,null,4,"div",[["class","highlight"],["margin-bottom",""]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n            "])),(n()(),z._31(2,0,null,null,1,"addon-mod-forum-post",[],null,[[null,"onPostChange"]],function(n,l,t){var u=!0;if("onPostChange"===l){u=!1!==n.component.postListChanged()&&u}return u},D,ft)),z._30(3,245760,null,0,rt.a,[en.a,ct.a,un.a,Qn.a,Xn.a,_n.a,mn.a,fn.a,pn.a,dt.a,[2,el.a],_t.a,Nl.a,ln.a,tn.a],{post:[0,"post"],courseId:[1,"courseId"],discussionId:[2,"discussionId"],component:[3,"component"],componentId:[4,"componentId"],replyData:[5,"replyData"],originalData:[6,"originalData"],trackPosts:[7,"trackPosts"],forum:[8,"forum"],accessInfo:[9,"accessInfo"],ratingInfo:[10,"ratingInfo"]},{onPostChange:"onPostChange"}),(n()(),z._55(-1,null,["\n        "]))],function(n,l){var t=l.component;n(l,3,1,[t.discussion,t.courseId,t.discussionId,t.component,t.cmId,t.replyData,t.originalData,t.trackPosts,t.forum,t.accessInfo,t.ratingInfo])},null)}function U(n){return z._57(0,[(n()(),z._31(0,0,null,null,5,"ion-item-divider",[["class","item item-divider"]],null,null,null,Dl.b,Dl.a)),z._30(1,1097728,null,3,jl.a,[wl.a,zn.a,z.t,z.V,[2,Ll.a]],null,null),z._52(335544320,4,{contentLabel:0}),z._52(603979776,5,{_buttons:1}),z._52(603979776,6,{_icons:1}),z._30(5,16384,null,0,lt.a,[zn.a,z.t,z.V],null,null)],null,null)}function T(n){return z._57(0,[(n()(),z._31(0,0,null,null,7,null,null,null,null,null,null,null)),(n()(),z._55(-1,null,["\n                "])),(n()(),z._26(16777216,null,null,1,null,U)),z._30(3,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n                "])),(n()(),z._31(5,0,null,null,1,"addon-mod-forum-post",[],null,[[null,"onPostChange"]],function(n,l,t){var u=!0;if("onPostChange"===l){u=!1!==n.component.postListChanged()&&u}return u},D,ft)),z._30(6,245760,null,0,rt.a,[en.a,ct.a,un.a,Qn.a,Xn.a,_n.a,mn.a,fn.a,pn.a,dt.a,[2,el.a],_t.a,Nl.a,ln.a,tn.a],{post:[0,"post"],courseId:[1,"courseId"],discussionId:[2,"discussionId"],component:[3,"component"],componentId:[4,"componentId"],replyData:[5,"replyData"],originalData:[6,"originalData"],trackPosts:[7,"trackPosts"],forum:[8,"forum"],accessInfo:[9,"accessInfo"],parentSubject:[10,"parentSubject"],ratingInfo:[11,"ratingInfo"]},{onPostChange:"onPostChange"}),(n()(),z._55(-1,null,["\n            "]))],function(n,l){var t=l.component;n(l,3,0,!l.context.first);n(l,6,1,[l.context.$implicit,t.courseId,t.discussionId,t.component,t.cmId,t.replyData,t.originalData,t.trackPosts,t.forum,t.accessInfo,t.postSubjects[l.context.$implicit.parent],t.ratingInfo])},null)}function R(n){return z._57(0,[(n()(),z._31(0,0,null,null,5,"ion-card",[],null,null,null,null,null)),z._30(1,16384,null,0,ml.a,[zn.a,z.t,z.V],null,null),(n()(),z._55(-1,null,["\n            "])),(n()(),z._26(16777216,null,null,1,null,T)),z._30(4,802816,null,0,yl.j,[z._11,z._6,z.E],{ngForOf:[0,"ngForOf"]},null),(n()(),z._55(-1,null,["\n        "]))],function(n,l){n(l,4,0,l.component.posts)},null)}function N(n){return z._57(0,[(n()(),z._31(0,0,null,null,0,null,null,null,null,null,null,null))],null,null)}function F(n){return z._57(0,[(n()(),z._31(0,0,null,null,5,null,null,null,null,null,null,null)),(n()(),z._55(-1,null,["\n                "])),(n()(),z._26(16777216,null,null,2,null,N)),z._30(3,540672,null,0,yl.r,[z._11],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),z._48(4,{post:0}),(n()(),z._55(-1,null,["\n            "]))],function(n,l){n(l,3,0,n(l,4,0,l.context.$implicit),z._44(l.parent.parent,104))},null)}function H(n){return z._57(0,[(n()(),z._31(0,0,null,null,4,null,null,null,null,null,null,null)),(n()(),z._55(-1,null,["\n            "])),(n()(),z._26(16777216,null,null,1,null,F)),z._30(3,802816,null,0,yl.j,[z._11,z._6,z.E],{ngForOf:[0,"ngForOf"]},null),(n()(),z._55(-1,null,["\n        "]))],function(n,l){n(l,3,0,l.component.posts)},null)}function q(n){return z._57(0,[(n()(),z._31(0,0,null,null,0,null,null,null,null,null,null,null))],null,null)}function $(n){return z._57(0,[(n()(),z._31(0,0,null,null,5,null,null,null,null,null,null,null)),(n()(),z._55(-1,null,["\n                    "])),(n()(),z._26(16777216,null,null,2,null,q)),z._30(3,540672,null,0,yl.r,[z._11],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),z._48(4,{post:0}),(n()(),z._55(-1,null,["\n                "]))],function(n,l){n(l,3,0,n(l,4,0,l.context.$implicit),z._44(l.parent.parent.parent,104))},null)}function G(n){return z._57(0,[(n()(),z._31(0,0,null,null,4,"div",[["padding-left",""]],null,null,null,null,null)),(n()(),z._55(-1,null,["\n                "])),(n()(),z._26(16777216,null,null,1,null,$)),z._30(3,802816,null,0,yl.j,[z._11,z._6,z.E],{ngForOf:[0,"ngForOf"]},null),(n()(),z._55(-1,null,["\n            "]))],function(n,l){n(l,3,0,l.parent.context.post.children)},null)}function Y(n){return z._57(0,[(n()(),z._55(-1,null,["\n            "])),(n()(),z._31(1,0,null,null,5,"ion-card",[],null,null,null,null,null)),z._30(2,16384,null,0,ml.a,[zn.a,z.t,z.V],null,null),(n()(),z._55(-1,null,["\n                "])),(n()(),z._31(4,0,null,null,1,"addon-mod-forum-post",[],null,[[null,"onPostChange"]],function(n,l,t){var u=!0;if("onPostChange"===l){u=!1!==n.component.postListChanged()&&u}return u},D,ft)),z._30(5,245760,null,0,rt.a,[en.a,ct.a,un.a,Qn.a,Xn.a,_n.a,mn.a,fn.a,pn.a,dt.a,[2,el.a],_t.a,Nl.a,ln.a,tn.a],{post:[0,"post"],courseId:[1,"courseId"],discussionId:[2,"discussionId"],component:[3,"component"],componentId:[4,"componentId"],replyData:[5,"replyData"],originalData:[6,"originalData"],trackPosts:[7,"trackPosts"],forum:[8,"forum"],accessInfo:[9,"accessInfo"],parentSubject:[10,"parentSubject"],ratingInfo:[11,"ratingInfo"]},{onPostChange:"onPostChange"}),(n()(),z._55(-1,null,["\n            "])),(n()(),z._55(-1,null,["\n            "])),(n()(),z._26(16777216,null,null,1,null,G)),z._30(9,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,null,["\n        "]))],function(n,l){var t=l.component;n(l,5,1,[l.context.post,t.courseId,t.discussionId,t.component,t.cmId,t.replyData,t.originalData,t.trackPosts,t.forum,t.accessInfo,t.postSubjects[l.context.post.parent],t.ratingInfo]);n(l,9,0,l.context.post.children.length&&l.context.post.children[0].subject)},null)}function K(n){return z._57(0,[z._52(402653184,1,{content:0}),(n()(),z._31(1,0,null,null,16,"ion-header",[],null,null,null,null,null)),z._30(2,16384,null,0,mt.a,[zn.a,z.t,z.V,[2,pt.a]],null,null),(n()(),z._55(-1,null,["\n    "])),(n()(),z._31(4,0,null,null,12,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,gt.b,gt.a)),z._30(5,49152,null,0,Wn.a,[Xl.a,[2,pt.a],[2,ol.a],zn.a,z.t,z.V],null,null),z._30(6,212992,null,0,ht.a,[Wn.a,Zn.a,Xn.a,ln.a],null,null),(n()(),z._55(-1,3,["\n        "])),(n()(),z._26(16777216,null,3,1,null,j)),z._30(9,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,3,["\n        "])),(n()(),z._31(11,0,null,2,4,"ion-buttons",[["end",""]],null,null,null,null,null)),z._30(12,16384,null,1,It.a,[zn.a,z.t,z.V,[2,Bn.a],[2,Wn.a]],null,null),z._52(603979776,2,{_buttons:1}),(n()(),z._55(-1,null,["\n            "])),(n()(),z._55(-1,null,["\n        "])),(n()(),z._55(-1,3,["\n    "])),(n()(),z._55(-1,null,["\n"])),(n()(),z._55(-1,null,["\n"])),(n()(),z._31(19,0,null,null,49,"core-navbar-buttons",[["end",""]],null,null,null,vt.b,vt.a)),z._30(20,245760,null,1,bt.a,[z.t,ll.a,un.a],null,null),z._52(603979776,3,{buttons:1}),(n()(),z._55(-1,0,["\n    "])),(n()(),z._31(23,0,null,0,44,"core-context-menu",[],null,null,null,yt.b,yt.a)),z._30(24,245760,null,0,_l.a,[Xn.a,_t.a,z.t,un.a,[2,Pt.a],on.a],null,null),(n()(),z._55(-1,0,["\n        "])),(n()(),z._26(16777216,null,0,1,null,w)),z._30(27,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,0,["\n        "])),(n()(),z._26(16777216,null,0,1,null,L)),z._30(30,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,0,["\n        "])),(n()(),z._31(32,0,null,0,2,"core-context-menu-item",[["iconAction","arrow-round-down"]],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.changeSort("flat-oldest")&&u}return u},cl.b,cl.a)),z._30(33,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n        "])),(n()(),z._31(36,0,null,0,2,"core-context-menu-item",[["iconAction","arrow-round-up"]],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.changeSort("flat-newest")&&u}return u},cl.b,cl.a)),z._30(37,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n        "])),(n()(),z._31(40,0,null,0,2,"core-context-menu-item",[["iconAction","swap"]],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.changeSort("nested")&&u}return u},cl.b,cl.a)),z._30(41,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n        "])),(n()(),z._31(44,0,null,0,2,"core-context-menu-item",[["iconAction","fa-lock"]],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.setLockState(!0)&&u}return u},cl.b,cl.a)),z._30(45,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n        "])),(n()(),z._31(48,0,null,0,2,"core-context-menu-item",[["iconAction","fa-unlock"]],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.setLockState(!1)&&u}return u},cl.b,cl.a)),z._30(49,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n        "])),(n()(),z._31(52,0,null,0,2,"core-context-menu-item",[["iconAction","fa-map-pin"]],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.setPinState(!0)&&u}return u},cl.b,cl.a)),z._30(53,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n        "])),(n()(),z._31(56,0,null,0,2,"core-context-menu-item",[["iconAction","fa-map-pin"]],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.setPinState(!1)&&u}return u},cl.b,cl.a)),z._30(57,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],iconSlash:[2,"iconSlash"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n        "])),(n()(),z._31(60,0,null,0,2,"core-context-menu-item",[["iconAction","fa-star"]],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.toggleFavouriteState(!0)&&u}return u},cl.b,cl.a)),z._30(61,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n        "])),(n()(),z._31(64,0,null,0,2,"core-context-menu-item",[["iconAction","fa-star"]],null,[[null,"action"]],function(n,l,t){var u=!0;if("action"===l){u=!1!==n.component.toggleFavouriteState(!1)&&u}return u},cl.b,cl.a)),z._30(65,770048,null,0,dl.a,[_l.a],{content:[0,"content"],iconAction:[1,"iconAction"],iconSlash:[2,"iconSlash"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,0,["\n    "])),(n()(),z._55(-1,0,["\n"])),(n()(),z._55(-1,null,["\n"])),(n()(),z._31(70,0,null,null,36,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,kt.b,kt.a)),z._30(71,4374528,[[1,4]],0,el.a,[zn.a,Zn.a,Wl.a,z.t,z.V,Xl.a,Ct.a,z.M,[2,pt.a],[2,ol.a]],null,null),(n()(),z._55(-1,1,["\n    "])),(n()(),z._31(73,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(n,l,t){var u=!0;if("ionRefresh"===l){u=!1!==n.component.doRefresh(t)&&u}return u},null,null)),z._30(74,212992,null,0,St.a,[Zn.a,el.a,z.M,Bl.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(n()(),z._55(-1,null,["\n        "])),(n()(),z._31(76,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,xt.b,xt.a)),z._30(77,114688,null,0,Ot.a,[St.a,zn.a],{pullingText:[0,"pullingText"]},null),z._47(131072,fl.a,[Xn.a,z.j]),(n()(),z._55(-1,null,["\n    "])),(n()(),z._55(-1,1,["\n\n    "])),(n()(),z._31(81,0,null,1,24,"core-loading",[],null,null,null,Dt.b,Dt.a)),z._30(82,638976,null,0,jt.a,[Xn.a,z.t,ln.a,on.a],{hideUntil:[0,"hideUntil"]},null),(n()(),z._55(-1,0,["\n        "])),(n()(),z._55(-1,0,["\n        "])),(n()(),z._26(16777216,null,0,1,null,V)),z._30(86,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,0,["\n\n        "])),(n()(),z._55(-1,0,["\n        "])),(n()(),z._26(16777216,null,0,1,null,A)),z._30(90,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,0,["\n\n        "])),(n()(),z._26(16777216,null,0,1,null,E)),z._30(93,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,0,["\n\n        "])),(n()(),z._26(16777216,null,0,1,null,M)),z._30(96,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,0,["\n\n        "])),(n()(),z._26(16777216,null,0,1,null,R)),z._30(99,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,0,["\n\n        "])),(n()(),z._26(16777216,null,0,1,null,H)),z._30(102,16384,null,0,yl.k,[z._11,z._6],{ngIf:[0,"ngIf"]},null),(n()(),z._55(-1,0,["\n\n        "])),(n()(),z._26(0,[["nestedPosts",2]],0,0,null,Y)),(n()(),z._55(-1,0,["\n    "])),(n()(),z._55(-1,1,["\n"])),(n()(),z._55(-1,null,["\n"]))],function(n,l){var t=l.component;n(l,6,0);n(l,9,0,t.discussion),n(l,20,0),n(l,24,0);n(l,27,0,t.discussionLoaded&&!t.postHasOffline&&t.isOnline);n(l,30,0,t.discussionLoaded&&!t.isSplitViewOn&&t.postHasOffline&&t.isOnline);n(l,33,0,z._56(l,33,0,z._44(l,34).transform("addon.mod_forum.modeflatoldestfirst")),"arrow-round-down",500,"flat-oldest"==t.sort);n(l,37,0,z._56(l,37,0,z._44(l,38).transform("addon.mod_forum.modeflatnewestfirst")),"arrow-round-up",450,"flat-newest"==t.sort);n(l,41,0,z._56(l,41,0,z._44(l,42).transform("addon.mod_forum.modenested")),"swap",400,"nested"==t.sort);n(l,45,0,z._56(l,45,0,z._44(l,46).transform("addon.mod_forum.lockdiscussion")),"fa-lock",300,!t.discussion||!t.discussion.canlock||t.discussion.locked);n(l,49,0,z._56(l,49,0,z._44(l,50).transform("addon.mod_forum.unlockdiscussion")),"fa-unlock",300,!t.discussion||!t.discussion.canlock||!t.discussion.locked);n(l,53,0,z._56(l,53,0,z._44(l,54).transform("addon.mod_forum.pindiscussion")),"fa-map-pin",250,!t.discussion||!t.canPin||t.discussion.pinned);n(l,57,0,z._56(l,57,0,z._44(l,58).transform("addon.mod_forum.unpindiscussion")),"fa-map-pin",!0,250,!t.discussion||!t.canPin||!t.discussion.pinned);n(l,61,0,z._56(l,61,0,z._44(l,62).transform("addon.mod_forum.addtofavourites")),"fa-star",200,!t.discussion||!t.discussion.canfavourite||t.discussion.starred);n(l,65,0,z._56(l,65,0,z._44(l,66).transform("addon.mod_forum.removefromfavourites")),"fa-star",!0,200,!t.discussion||!t.discussion.canfavourite||!t.discussion.starred);n(l,74,0,t.discussionLoaded);n(l,77,0,z._34(1,"",z._56(l,77,0,z._44(l,78).transform("core.pulltorefresh")),""));n(l,82,0,t.discussionLoaded);n(l,86,0,t.postHasOffline||t.hasOfflineRatings);n(l,90,0,t.availabilityMessage);n(l,93,0,t.discussion&&t.discussion.locked);n(l,96,0,t.discussion);n(l,99,0,"nested"!=t.sort);n(l,102,0,"nested"==t.sort)},function(n,l){n(l,4,0,z._44(l,5)._hidden,z._44(l,5)._sbPadding);n(l,70,0,z._44(l,71).statusbarPadding,z._44(l,71)._hasRefresher);n(l,73,0,"inactive"!==z._44(l,74).state,z._44(l,74)._top);n(l,76,0,z._44(l,77).r.state)})}Object.defineProperty(l,"__esModule",{value:!0});var z=t(0),B=t(5),W=t(3),J=t(26),Q=t(31),X=t(735),Z=t(185),nn=t(10),ln=t(9),tn=t(1),un=t(4),on=t(2),en=t(72),an=t(46),sn=t(28),rn=t(231),cn=t(201),dn=t(236),_n=t(135),fn=t(233),mn=t(280),pn=t(254),gn=this&&this.__decorate||function(n,l,t,u){var o,e=arguments.length,a=e<3?l:null===u?u=Object.getOwnPropertyDescriptor(l,t):u;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(n,l,t,u);else for(var i=n.length-1;i>=0;i--)(o=n[i])&&(a=(e<3?o(a):e>3?o(l,t,a):o(l,t))||a);return e>3&&a&&Object.defineProperty(l,t,a),a},hn=this&&this.__metadata||function(n,l){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,l)},In=this&&this.__param||function(n,l){return function(t,u){l(t,u,n)}},vn=function(){function n(n,l,t,u,o,e,a,i,s,r,c,d,_,f,m,p,g,h){var I=this;this.appProvider=u,this.eventsProvider=o,this.sitesProvider=e,this.domUtils=a,this.utils=i,this.translate=s,this.uploaderProvider=r,this.forumProvider=c,this.forumOffline=d,this.forumHelper=_,this.forumSync=f,this.ratingOffline=m,this.userProvider=p,this.svComponent=g,this.navCtrl=h,this.forum={},this.accessInfo={},this.discussionLoaded=!1,this.sort="nested",this.replyData={replyingTo:0,isEditing:!1,subject:"",message:null,files:[],isprivatereply:!1},this.originalData={subject:null,message:null,files:[],isprivatereply:!1},this.refreshIcon="spinner",this.syncIcon="spinner",this.discussionStr="",this.component=_n.a.COMPONENT,this.canPin=!1,this.courseId=n.get("courseId"),this.cmId=n.get("cmId"),this.forumId=n.get("forumId"),this.discussion=n.get("discussion"),this.discussionId=this.discussion?this.discussion.discussion:n.get("discussionId"),this.trackPosts=n.get("trackPosts"),this.postId=n.get("postId"),this.isOnline=this.appProvider.isOnline(),this.onlineObserver=l.onchange().subscribe(function(){t.run(function(){I.isOnline=I.appProvider.isOnline()})}),this.isSplitViewOn=this.svComponent&&this.svComponent.isOn(),this.discussionStr=s.instant("addon.mod_forum.discussion")}return n.prototype.ionViewDidLoad=function(){var n=this;this.sitesProvider.getCurrentSite().getLocalSiteConfig("AddonModForumDiscussionSort").catch(function(){n.userProvider.getUserPreference("forum_displaymode").catch(function(){}).then(function(l){switch(l&&parseInt(l,10)){case 1:n.sort="flat-oldest";break;case-1:n.sort="flat-newest";break;case 3:n.sort="nested"}})}).then(function(l){n.sort=l}).finally(function(){n.fetchPosts(!0,!1,!0).then(function(){n.postId&&setTimeout(function(){n.domUtils.scrollToElementBySelector(n.content,"#addon-mod_forum-post-"+n.postId)})})})},n.prototype.ionViewDidEnter=function(){var n=this;this.syncObserver=this.eventsProvider.on(pn.a.AUTO_SYNCED,function(l){l.forumId==n.forumId&&n.discussionId==l.discussionId&&l.userId==n.sitesProvider.getCurrentSiteUserId()&&(n.discussionLoaded=!1,n.refreshPosts())},this.sitesProvider.getCurrentSiteId()),this.syncManualObserver=this.eventsProvider.on(pn.a.MANUAL_SYNCED,function(l){"discussion"!=l.source&&l.forumId==n.forumId&&l.userId==n.sitesProvider.getCurrentSiteUserId()&&(n.discussionLoaded=!1,n.refreshPosts())},this.sitesProvider.getCurrentSiteId()),this.eventsProvider.trigger(_n.a.VIEW_DISCUSSION_EVENT,{forumId:this.forumId,discussion:this.discussionId},this.sitesProvider.getCurrentSiteId()),this.ratingOfflineObserver=this.eventsProvider.on(rn.a.RATING_SAVED_EVENT,function(l){"mod_forum"==l.component&&"post"==l.ratingArea&&"module"==l.contextLevel&&l.instanceId==n.cmId&&l.itemSetId==n.discussionId&&(n.hasOfflineRatings=!0)}),this.ratingSyncObserver=this.eventsProvider.on(dn.a.SYNCED_EVENT,function(l){"mod_forum"==l.component&&"post"==l.ratingArea&&"module"==l.contextLevel&&l.instanceId==n.cmId&&l.itemSetId==n.discussionId&&(n.hasOfflineRatings=!1)}),this.changeDiscObserver=this.eventsProvider.on(_n.a.CHANGE_DISCUSSION_EVENT,function(l){(n.forumId&&n.forumId===l.forumId||l.cmId===n.cmId)&&n.forumProvider.invalidateDiscussionsList(n.forumId).finally(function(){void 0!==l.locked&&(n.discussion.locked=l.locked),void 0!==l.pinned&&(n.discussion.pinned=l.pinned),void 0!==l.starred&&(n.discussion.starred=l.starred),void 0!==l.deleted&&l.deleted&&(0==l.post.parent?n.svComponent&&n.svComponent.isOn()?n.svComponent.emptyDetails():n.navCtrl.pop():(n.discussionLoaded=!1,n.refreshPosts()))})})},n.prototype.ionViewCanLeave=function(){var n=this;return(this.forumHelper.hasPostDataChanged(this.replyData,this.originalData)?this.domUtils.showConfirm(this.translate.instant("core.confirmcanceledit")):Promise.resolve()).then(function(){n.uploaderProvider.clearTmpFiles(n.replyData.files)})},n.prototype.fetchForum=function(){return this.courseId&&this.cmId?this.forumProvider.getForum(this.courseId,this.cmId):this.courseId&&this.forumId?this.forumProvider.getForumById(this.courseId,this.forumId):Promise.reject(null)},n.prototype.fetchPosts=function(n,l,t){var u,o=this,e=[],a=[],i=!1;return(n?this.syncDiscussion(l).catch(function(){}):Promise.resolve()).then(function(){return o.forumProvider.getDiscussionPosts(o.discussionId).then(function(n){e=n.posts,u=n.ratinginfo}).then(function(){return o.forumOffline.getDiscussionReplies(o.discussionId).then(function(n){o.postHasOffline=!!n.length;var l=[],t={};return e.forEach(function(n){t[n.id]=n,i=i||!n.postread}),n.forEach(function(n){o.forumId||(o.forumId=n.forumid),o.courseId||(o.courseId=n.courseid),l.push(o.forumHelper.convertOfflineReplyToOnline(n).then(function(n){a.push(n),t[n.parent].canreply=!1}))}),Promise.all(l).then(function(){e=o.utils.objectToArray(t)})})})}).then(function(){var n=a.concat(e),l=o.forumProvider.extractStartingPost(n);if(l&&(o.discussion=Object.assign(o.discussion||{},l)),"nested"==o.sort)o.forumProvider.sortDiscussionPosts(n,"ASC"),n=o.utils.formatTree(n,"parent","id",o.discussion.id);else{o.forumProvider.sortDiscussionPosts(n,"flat-newest"==o.sort?"DESC":"ASC")}return o.fetchForum().then(function(l){void 0!==l.istracked&&(o.trackPosts=l.istracked),o.forumId=l.id,o.cmId=l.cmid,o.courseId=l.course,o.forum=l,o.availabilityMessage=o.forumHelper.getAvailabilityMessage(l);var t=[];return t.push(o.forumProvider.getAccessInformation(o.forumId).then(function(t){o.accessInfo=t,o.forumHelper.isCutoffDateReached(l)&&!t.cancanoverridecutoff&&n.forEach(function(n){n.canreply=!1})})),o.discussion||t.push(o.loadDiscussion(o.forumId,o.discussionId)),Promise.all(t)}).catch(function(){}).then(function(){if(!o.discussion)return Promise.reject("Invalid forum discussion.");o.discussion.userfullname&&0==o.discussion.parent&&"single"==o.forum.type&&(o.discussion.userfullname=null),o.posts=n,o.ratingInfo=u,o.postSubjects=o.getAllPosts().reduce(function(n,l){return n[l.id]=l.subject,n},(l={},l[o.discussion.id]=o.discussion.subject,l));var l})}).then(function(){if(o.forumProvider.isSetPinStateAvailableForSite())return o.forumProvider.canAddDiscussionToAll(o.forumId).then(function(n){o.canPin=!!n.canpindiscussions}).catch(function(){o.canPin=!1});o.canPin=!1}).then(function(){return o.ratingOffline.hasRatings("mod_forum","post","module",o.cmId,o.discussionId).then(function(n){o.hasOfflineRatings=n})}).catch(function(n){o.domUtils.showErrorModal(n)}).finally(function(){o.discussionLoaded=!0,o.refreshIcon="refresh",o.syncIcon="sync",(t||i&&o.trackPosts)&&o.forumProvider.logDiscussionView(o.discussionId,o.forumId||-1,o.forum.name).catch(function(){}).finally(function(){o.eventsProvider.trigger(_n.a.MARK_READ_EVENT,{courseId:o.courseId,moduleId:o.cmId},o.sitesProvider.getCurrentSiteId())})})},n.prototype.loadDiscussion=function(n,l){var t=this;return!this.discussion&&n?this.forumHelper.getDiscussionById(n,l).then(function(n){t.discussion=n,t.discussionId=t.discussion.discussion}).catch(function(){}):Promise.resolve()},n.prototype.syncDiscussion=function(n){var l=this,t=[];return t.push(this.forumSync.syncDiscussionReplies(this.discussionId).then(function(n){return n.warnings&&n.warnings.length&&l.domUtils.showErrorModal(n.warnings[0]),n&&n.updated&&l.eventsProvider.trigger(pn.a.MANUAL_SYNCED,{forumId:l.forumId,userId:l.sitesProvider.getCurrentSiteUserId(),source:"discussion"},l.sitesProvider.getCurrentSiteId()),n.updated})),t.push(this.forumSync.syncRatings(this.cmId,this.discussionId).then(function(n){n.warnings&&n.warnings.length&&l.domUtils.showErrorModal(n.warnings[0])})),Promise.all(t).catch(function(t){return n&&l.domUtils.showErrorModalDefault(t,"core.errorsync",!0),Promise.reject(null)})},n.prototype.doRefresh=function(n,l,t){return void 0===t&&(t=!1),this.discussionLoaded?this.refreshPosts(!0,t).finally(function(){n&&n.complete(),l&&l()}):Promise.resolve()},n.prototype.refreshPosts=function(n,l){var t=this;this.domUtils.scrollToTop(this.content),this.refreshIcon="spinner",this.syncIcon="spinner";var u=[this.forumProvider.invalidateForumData(this.courseId),this.forumProvider.invalidateDiscussionPosts(this.discussionId,this.forumId),this.forumProvider.invalidateAccessInformation(this.forumId),this.forumProvider.invalidateCanAddDiscussion(this.forumId)];return this.utils.allPromises(u).catch(function(){}).then(function(){return t.fetchPosts(n,l)})},n.prototype.changeSort=function(n){return this.discussionLoaded=!1,this.sort=n,this.sitesProvider.getCurrentSite().setLocalSiteConfig("AddonModForumDiscussionSort",this.sort),this.domUtils.scrollToTop(this.content),this.fetchPosts()},n.prototype.setLockState=function(n){var l=this,t=this.domUtils.showModalLoading("core.sending",!0);this.forumProvider.setLockState(this.forumId,this.discussionId,n).then(function(n){l.discussion.locked=n.locked;l.eventsProvider.trigger(_n.a.CHANGE_DISCUSSION_EVENT,{forumId:l.forumId,discussionId:l.discussionId,cmId:l.cmId,locked:l.discussion.locked},l.sitesProvider.getCurrentSiteId()),l.domUtils.showToast("addon.mod_forum.lockupdated",!0)}).catch(function(n){l.domUtils.showErrorModal(n)}).finally(function(){t.dismiss()})},n.prototype.setPinState=function(n){var l=this,t=this.domUtils.showModalLoading("core.sending",!0);this.forumProvider.setPinState(this.discussionId,n).then(function(){l.discussion.pinned=n;l.eventsProvider.trigger(_n.a.CHANGE_DISCUSSION_EVENT,{forumId:l.forumId,discussionId:l.discussionId,cmId:l.cmId,pinned:l.discussion.pinned},l.sitesProvider.getCurrentSiteId()),l.domUtils.showToast("addon.mod_forum.pinupdated",!0)}).catch(function(n){l.domUtils.showErrorModal(n)}).finally(function(){t.dismiss()})},n.prototype.toggleFavouriteState=function(n){var l=this,t=this.domUtils.showModalLoading("core.sending",!0);this.forumProvider.toggleFavouriteState(this.discussionId,n).then(function(){l.discussion.starred=n;l.eventsProvider.trigger(_n.a.CHANGE_DISCUSSION_EVENT,{forumId:l.forumId,discussionId:l.discussionId,cmId:l.cmId,starred:l.discussion.starred},l.sitesProvider.getCurrentSiteId()),l.domUtils.showToast("addon.mod_forum.favouriteupdated",!0)}).catch(function(n){l.domUtils.showErrorModal(n)}).finally(function(){t.dismiss()})},n.prototype.postListChanged=function(){var n=this;this.eventsProvider.trigger(_n.a.REPLY_DISCUSSION_EVENT,{forumId:this.forumId,discussionId:this.discussionId,cmId:this.cmId},this.sitesProvider.getCurrentSiteId()),this.discussionLoaded=!1,this.refreshPosts().finally(function(){n.discussionLoaded=!0})},n.prototype.ionViewWillLeave=function(){this.syncObserver&&this.syncObserver.off(),this.syncManualObserver&&this.syncManualObserver.off(),this.ratingOfflineObserver&&this.ratingOfflineObserver.off(),this.ratingSyncObserver&&this.ratingSyncObserver.off(),this.changeDiscObserver&&this.changeDiscObserver.off()},n.prototype.ngOnDestroy=function(){this.onlineObserver&&this.onlineObserver.unsubscribe()},n.prototype.getAllPosts=function(){return[].concat.apply([],this.posts.map(this.flattenPostHierarchy.bind(this)))},n.prototype.flattenPostHierarchy=function(n){for(var l=[n],t=0,u=n.children||[];t<u.length;t++){l.push.apply(l,this.flattenPostHierarchy(u[t]))}return l},gn([Object(z._9)(B.f),hn("design:type",B.f)],n.prototype,"content",void 0),n=gn([Object(z.m)({selector:"page-addon-mod-forum-discussion",templateUrl:"discussion.html"}),In(16,Object(z.N)()),hn("design:paramtypes",[B.t,Z.a,z.M,nn.a,ln.a,tn.a,un.a,on.a,W.c,en.a,_n.a,fn.a,mn.a,pn.a,cn.a,an.a,sn.a,B.s])],n)}(),bn=this&&this.__decorate||function(n,l,t,u){var o,e=arguments.length,a=e<3?l:null===u?u=Object.getOwnPropertyDescriptor(l,t):u;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(n,l,t,u);else for(var i=n.length-1;i>=0;i--)(o=n[i])&&(a=(e<3?o(a):e>3?o(l,t,a):o(l,t))||a);return e>3&&a&&Object.defineProperty(l,t,a),a},yn=function(){function n(){}return n=bn([Object(z.I)({declarations:[vn],imports:[J.a,Q.a,X.a,B.l.forChild(vn),W.b.forChild()]})],n)}(),Pn=t(1522),kn=t(1523),Cn=t(1524),Sn=t(1525),xn=t(1526),On=t(1527),Dn=t(1528),jn=t(1529),wn=t(1530),Ln=t(1531),Vn=t(1532),An=t(1533),En=t(1534),Mn=t(1537),Un=t(1538),Tn=t(1535),Rn=t(1536),Nn=t(1539),Fn=t(1540),Hn=t(272),qn=t(1566),$n=t(1575),Gn=t(1576),Yn=t(722),Kn=t(314),zn=t(8),Bn=t(247),Wn=t(211),Jn=t(48),Qn=t(11),Xn=t(17),Zn=t(16),nl=t(22),ll=t(6),tl=t(18),ul=t(15),ol=t(21),el=t(29),al=t(44),il=t(41),sl=t(32),rl=t(36),cl=t(92),dl=t(83),_l=t(78),fl=t(25),ml=t(89),pl=t(47),gl=t(80),hl=t(75),Il=t(248),vl=t(45),bl=t(42),yl=t(7),Pl=t(213),kl=t(160),Cl=t(182),Sl=t(530),xl=t(326),Ol=t(66),Dl=t(30),jl=t(20),wl=t(19),Ll=t(27),Vl=t(33),Al=t(494),El=t(324),Ml=t(2129),Ul=t(1547),Tl=t(2130),Rl=t(1546),Nl=t(162),Fl=t(67),Hl=t(251),ql=t(199),$l=t(23),Gl=t(481),Yl=t(316),Kl=t(149),zl=t(86),Bl=t(43),Wl=t(34),Jl=t(110),Ql=t(90),Xl=t(35),Zl=t(250),nt=t(216),lt=t(100),tt=t(164),ut=t(119),ot=t(120),et=t(228),at=t(24),it=t(318),st=t(486),rt=t(1590),ct=t(81),dt=t(163),_t=t(70),ft=z._29({encapsulation:2,styles:[],data:{}}),mt=(z._27("addon-mod-forum-post",rt.a,function(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"addon-mod-forum-post",[],null,null,null,D,ft)),z._30(1,245760,null,0,rt.a,[en.a,ct.a,un.a,Qn.a,Xn.a,_n.a,mn.a,fn.a,pn.a,dt.a,[2,el.a],_t.a,Nl.a,ln.a,tn.a],null,null)],function(n,l){n(l,1,0)},null)},{post:"post",courseId:"courseId",discussionId:"discussionId",component:"component",componentId:"componentId",replyData:"replyData",originalData:"originalData",trackPosts:"trackPosts",forum:"forum",accessInfo:"accessInfo",parentSubject:"parentSubject",ratingInfo:"ratingInfo"},{onPostChange:"onPostChange"},[]),t(370)),pt=t(39),gt=t(721),ht=t(473),It=t(371),vt=t(96),bt=t(87),yt=t(91),Pt=t(76),kt=t(181),Ct=t(107),St=t(159),xt=t(212),Ot=t(173),Dt=t(54),jt=t(51),wt=t(69),Lt=z._29({encapsulation:2,styles:[],data:{}}),Vt=z._27("page-addon-mod-forum-discussion",vn,function(n){return z._57(0,[(n()(),z._31(0,0,null,null,1,"page-addon-mod-forum-discussion",[],null,null,null,K,Lt)),z._30(1,180224,null,0,vn,[wt.a,Z.a,z.M,nn.a,ln.a,tn.a,un.a,on.a,Xn.a,en.a,_n.a,fn.a,mn.a,pn.a,cn.a,an.a,[2,sn.a],ol.a],null,null)],null,null)},{},{},[]),At=t(366),Et=t(367),Mt=t(369),Ut=t(368),Tt=t(472),Rt=t(720),Nt=t(106),Ft=t(271),Ht=t(74),qt=t(731),$t=t(274),Gt=t(214),Yt=t(270);t.d(l,"AddonModForumDiscussionPageModuleNgFactory",function(){return Kt});var Kt=z._28(yn,[],function(n){return z._40([z._41(512,z.o,z._21,[[8,[Pn.a,kn.a,Cn.a,Sn.a,xn.a,On.a,Dn.a,jn.a,wn.a,Ln.a,Vn.a,An.a,En.a,Mn.a,Un.a,Tn.a,Rn.a,Nn.a,Fn.a,Hn.a,qn.a,$n.a,Gn.a,Vt]],[3,z.o],z.K]),z._41(4608,yl.m,yl.l,[z.G,[2,yl.w]]),z._41(4608,$l.x,$l.x,[]),z._41(4608,$l.d,$l.d,[]),z._41(4608,At.b,At.a,[]),z._41(4608,Et.a,Et.b,[]),z._41(4608,Mt.b,Mt.a,[]),z._41(4608,Ut.b,Ut.a,[]),z._41(4608,Xn.a,Xn.a,[Tt.a,At.b,Et.a,Mt.b,Ut.b,Xn.b,Xn.c]),z._41(512,yl.b,yl.b,[]),z._41(512,$l.v,$l.v,[]),z._41(512,$l.i,$l.i,[]),z._41(512,$l.s,$l.s,[]),z._41(512,Rt.a,Rt.a,[]),z._41(512,W.b,W.b,[]),z._41(512,Q.a,Q.a,[]),z._41(512,Nt.a,Nt.a,[]),z._41(512,J.a,J.a,[]),z._41(512,Ft.a,Ft.a,[]),z._41(512,Ht.a,Ht.a,[]),z._41(512,qt.a,qt.a,[]),z._41(512,$t.a,$t.a,[]),z._41(512,Gt.a,Gt.a,[]),z._41(512,X.a,X.a,[]),z._41(512,Rt.b,Rt.b,[]),z._41(512,yn,yn,[]),z._41(256,Xn.c,void 0,[]),z._41(256,Xn.b,void 0,[]),z._41(256,Yt.a,vn,[])])})},2129:function(n,l,t){"use strict";function u(n){return a._57(0,[(n()(),a._31(0,0,null,null,2,"ion-option",[],null,null,null,null,null)),a._30(1,16384,[[4,4]],0,i.a,[a.t],{value:[0,"value"]},null),(n()(),a._55(2,null,["",""]))],function(n,l){n(l,1,0,l.context.$implicit.value)},function(n,l){n(l,2,0,l.context.$implicit.name)})}function o(n){return a._57(0,[(n()(),a._31(0,0,null,null,23,"ion-item",[["class","item item-block"],["text-wrap",""]],null,null,null,s.b,s.a)),a._30(1,1097728,null,3,r.a,[c.a,d.a,a.t,a.V,[2,_.a]],null,null),a._52(335544320,1,{contentLabel:0}),a._52(603979776,2,{_buttons:1}),a._52(603979776,3,{_icons:1}),a._30(5,16384,null,0,f.a,[],null,null),(n()(),a._55(-1,2,["\n    "])),(n()(),a._31(7,0,null,1,3,"ion-label",[],null,null,null,null,null)),a._30(8,16384,[[1,4]],0,m.a,[d.a,a.t,a.V,[8,null],[8,null],[8,null],[8,null]],null,null),(n()(),a._55(9,null,["",""])),a._47(131072,p.a,[g.a,a.j]),(n()(),a._55(-1,2,["\n    "])),(n()(),a._31(12,0,null,3,10,"ion-select",[["interface","action-sheet"],["text-start",""]],[[2,"select-disabled",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"click"],[null,"keyup.space"]],function(n,l,t){var u=!0,o=n.component;if("click"===l){u=!1!==a._44(n,13)._click(t)&&u}if("keyup.space"===l){u=!1!==a._44(n,13)._keyup()&&u}if("ngModelChange"===l){u=!1!==(o.rating=t)&&u}if("ngModelChange"===l){u=!1!==o.userRatingChanged()&&u}return u},h.b,h.a)),a._30(13,1228800,null,1,I.a,[v.a,c.a,d.a,a.t,a.V,[2,r.a],b.a],{disabled:[0,"disabled"],interface:[1,"interface"]},null),a._52(603979776,4,{options:1}),a._50(1024,null,y.l,function(n){return[n]},[I.a]),a._30(16,671744,null,0,y.q,[[8,null],[8,null],[8,null],[2,y.l]],{isDisabled:[0,"isDisabled"],model:[1,"model"]},{update:"ngModelChange"}),a._50(2048,null,y.m,null,[y.q]),a._30(18,16384,null,0,y.n,[y.m],null,null),(n()(),a._55(-1,null,["\n        "])),(n()(),a._26(16777216,null,null,1,null,u)),a._30(21,802816,null,0,P.j,[a._11,a._6,a.E],{ngForOf:[0,"ngForOf"]},null),(n()(),a._55(-1,null,["\n    "])),(n()(),a._55(-1,2,["\n"]))],function(n,l){var t=l.component;n(l,13,0,!t.item.canrate,"action-sheet");n(l,16,0,!t.item.canrate,t.rating);n(l,21,0,t.scale.items)},function(n,l){n(l,9,0,a._56(l,9,0,a._44(l,10).transform("core.rating.rating")));n(l,12,0,a._44(l,13)._disabled,a._44(l,18).ngClassUntouched,a._44(l,18).ngClassTouched,a._44(l,18).ngClassPristine,a._44(l,18).ngClassDirty,a._44(l,18).ngClassValid,a._44(l,18).ngClassInvalid,a._44(l,18).ngClassPending)})}function e(n){return a._57(0,[(n()(),a._26(16777216,null,null,1,null,o)),a._30(1,16384,null,0,P.k,[a._11,a._6],{ngIf:[0,"ngIf"]},null),(n()(),a._55(-1,null,["\n"]))],function(n,l){var t=l.component;n(l,1,0,t.item&&(t.item.canrate||null!=t.item.rating)&&!t.disabled)},null)}t.d(l,"a",function(){return j}),l.b=e;var a=t(0),i=t(108),s=t(30),r=t(20),c=t(19),d=t(8),_=t(27),f=t(33),m=t(67),p=t(25),g=t(17),h=t(123),I=t(109),v=t(35),b=t(59),y=t(23),P=t(7),k=t(1547),C=t(4),S=t(9),x=t(231),O=t(201),D=t(1),j=a._29({encapsulation:2,styles:[],data:{}});a._27("core-rating-rate",k.a,function(n){return a._57(0,[(n()(),a._31(0,0,null,null,1,"core-rating-rate",[],null,null,null,e,j)),a._30(1,704512,null,0,k.a,[C.a,g.a,S.a,x.a,O.a,D.a],null,null)],null,null)},{ratingInfo:"ratingInfo",contextLevel:"contextLevel",instanceId:"instanceId",itemId:"itemId",itemSetId:"itemSetId",courseId:"courseId",aggregateMethod:"aggregateMethod",scaleId:"scaleId",userId:"userId"},{onLoading:"onLoading",onUpdate:"onUpdate"},[])},2130:function(n,l,t){"use strict";function u(n){return a._57(0,[(n()(),a._31(0,0,null,null,1,"span",[],null,null,null,null,null)),(n()(),a._55(1,null,["(",")"]))],null,function(n,l){n(l,1,0,l.component.item.count)})}function o(n){return a._57(0,[(n()(),a._31(0,0,null,null,11,"a",[["class","item item-block"],["ion-item",""],["text-wrap",""]],[[1,"detail-none",0]],[[null,"click"]],function(n,l,t){var u=!0;if("click"===l){u=!1!==n.component.openRatings()&&u}return u},i.b,i.a)),a._30(1,1097728,null,3,s.a,[r.a,c.a,a.t,a.V,[2,d.a]],null,null),a._52(335544320,1,{contentLabel:0}),a._52(603979776,2,{_buttons:1}),a._52(603979776,3,{_icons:1}),a._30(5,16384,null,0,_.a,[],null,null),(n()(),a._55(6,2,["\n    ",""," ","\n    "])),a._47(131072,f.a,[m.a,a.j]),a._47(131072,f.a,[m.a,a.j]),(n()(),a._26(16777216,null,2,1,null,u)),a._30(10,16384,null,0,p.k,[a._11,a._6],{ngIf:[0,"ngIf"]},null),(n()(),a._55(-1,2,["\n"]))],function(n,l){var t=l.component;n(l,10,0,t.showCount&&t.item.count>0)},function(n,l){var t=l.component;n(l,0,0,!t.ratingInfo.canviewall||!t.item.count||null);n(l,6,0,a._56(l,6,0,a._44(l,7).transform(t.labelKey)),a._56(l,6,1,a._44(l,8).transform("core.labelsep")),t.item.aggregatestr||"-")})}function e(n){return a._57(0,[(n()(),a._26(16777216,null,null,1,null,o)),a._30(1,16384,null,0,p.k,[a._11,a._6],{ngIf:[0,"ngIf"]},null),(n()(),a._55(-1,null,["\n"]))],function(n,l){var t=l.component;n(l,1,0,t.item&&t.item.canviewaggregate&&t.labelKey&&!t.disabled)},null)}t.d(l,"a",function(){return y}),l.b=e;var a=t(0),i=t(30),s=t(20),r=t(19),c=t(8),d=t(27),_=t(33),f=t(25),m=t(17),p=t(7),g=t(1546),h=t(9),I=t(162),v=t(231),b=t(1),y=a._29({encapsulation:2,styles:[],data:{}});a._27("core-rating-aggregate",g.a,function(n){return a._57(0,[(n()(),a._31(0,0,null,null,1,"core-rating-aggregate",[],null,null,null,e,y)),a._30(1,704512,null,0,g.a,[h.a,I.a,v.a,b.a],null,null)],null,null)},{ratingInfo:"ratingInfo",contextLevel:"contextLevel",instanceId:"instanceId",itemId:"itemId",aggregateMethod:"aggregateMethod",scaleId:"scaleId",courseId:"courseId"},{},[])}});